var Efferent;(function(e){var t;(function(t){var i=e.Frontend.WebClient;var o=e.Frontend.WebClient.DOMUtils;class ConfigPlatformForm{Create(e,t,n){var a=new Array;var r=document.createElement("div");o.AddClass(r,"section");var l=document.createElement("div");o.AddClass(l,"block");r["connection"]=l;var s=new i.Form(l,t[0],n);s.AddField(new i.Field(i.EFieldType.Group,"",{text:"Smartlink Cache"},{},[]));s.AddField(new i.Field(i.EFieldType.Checkbox,"chkActiveLocalRepo",{label:"Enforce Local Cache",checked:t[0].localRepoActive,newline:false,styleLabel:"display: none",action:t[0].actionCheckLocalRepo},{display:"none"},[]));s.AddField(new i.Field(i.EFieldType.Checkbox,"chkAutomaticSelection",{label:"Automatic selection",checked:t[0].chkAutomaticSelection,newline:false,styleLabel:"display: none",action:t[0].actionCheckAutomaticSelection},{display:"none"},[]));s.AddField(new i.Field(i.EFieldType.Radio,"chkSmartLinkConnectionNone",{action:t[0].ActionChkSmartLinkConnectionNone,checked:t[0].checkedSmartLinkConnectionNone,label:"None",name:"radioSmartLinkConnection",newline:true},{width:"220px"},[]));s.AddField(new i.Field(i.EFieldType.Radio,"chkSmartLinkConnectionManual",{action:t[0].ActionChkSmartLinkConnectionManual,checked:t[0].checkedSmartLinkConnectionManual,label:"Manual",name:"radioSmartLinkConnection",newline:true},{width:"220px"},[]));s.AddField(new i.Field(i.EFieldType.Radio,"chkSmartLinkConnectionAutomatic",{action:t[0].ActionChkSmartLinkConnectionAutomatic,checked:t[0].checkedSmartLinkConnectionAutomatic,label:"Automatic",name:"radioSmartLinkConnection",newline:true},{width:"220px"},[]));s.AddField(new i.Field(i.EFieldType.Label,"textUrlLocalRepo",{text:"Local Cache URL",colon:false,width:110},{display:"inline-block",width:"170px"},[]));s.AddField(new i.Field(i.EFieldType.SelectBox,"urlLocalXC",{id:"IdUrlLocalRepo",newline:false,options:t[0].optionsLocalCache,values:t[0].valuesLocalCache,value:t[0].valueLocalCache,disabled:t[0].disabledLocalCache,action:t[0].actionUrlLocalXC,dataOptions:t[0].dataOptionsLocalCache},{width:"310px"},[]));s.AddField(new i.Field(i.EFieldType.Button,"BtnConnect",{id:"IdBtnConnect",text:"Connect"},{display:"inline-block","vertical-align":"top","margin-left":"10px","line-height":"1px",width:"80px",height:"25px"},["green","inline"],t[0].actionBtnConnect));s.Render();r.appendChild(l);var l=document.createElement("div");o.AddClass(l,"block");r["general"]=l;var s=new i.Form(l,t[0],n);s.AddField(new i.Field(i.EFieldType.Group,"",{text:"General"},{},[]));s.AddField(new i.Field(i.EFieldType.Label,"textBtLanguage",{text:"Language",newline:true,colon:false,width:110},{display:"inline-block"},[]));s.AddField(new i.Field(i.EFieldType.SelectBox,"selectLanguage",{options:["English","Spanish"],values:["en","es"],value:t[0].lang,action:t[0].actionSelectLanguage,width:220,newline:true},{},[]));s.AddField(new i.Field(i.EFieldType.Label,"textBtTheme",{text:"Theme",newline:true,colon:false,width:110},{},[]));s.AddField(new i.Field(i.EFieldType.SelectBox,"selectTheme",{options:["Dark","Light"],values:["Dark","Light"],value:t[0].theme,width:220,action:t[0].actionSelectTheme,newline:true},{},[]));s.AddField(new i.Field(i.EFieldType.Label,"textOnDoubleClick",{width:140,text:"On double-click",newline:t[0].showOrHideNewLine,colon:false},{},t[0].showOrHideClass));s.AddField(new i.Field(i.EFieldType.SelectBox,"selectOnDoubleClick",{options:["Open in same page","Open in a new tab"],values:["samePage","newTab"],value:t[0].onDoubleClick,width:220,action:t[0].actionSelectOnDoubleClick,newline:t[0].showOrHideNewLine},{},t[0].showOrHideClass));s.AddField(new i.Field(i.EFieldType.Label,"textDateFormat",{text:"Date format",newline:t[0].showOrHideNewLine,colon:false,width:110},{},t[0].showOrHideClass));s.AddField(new i.Field(i.EFieldType.SelectBox,"selectDateFormat",{options:["YYYY-MM-DD","MM-DD-YYYY","DD-MM-YYYY"],values:["YYYY-MM-DD","MM-DD-YYYY","DD-MM-YYYY"],value:t[0].dateFormat,width:220,action:t[0].actionSelectDateFormat,newline:t[0].showOrHideNewLine},{},t[0].showOrHideClass));s.AddField(new i.Field(i.EFieldType.Checkbox,"chkHighResSelection",{label:"High-Res mode",disabled:t[0].disabledHighResSelection,checked:t[0].chkHighResSelection,action:t[0].actionCheckHighResSelection},{},[]));s.Render();r.appendChild(l);e.appendChild(r);a.push(r);return a}}t.ConfigPlatformForm=ConfigPlatformForm})(t=e.PlatformClient||(e.PlatformClient={}))})(Efferent||(Efferent={}));var Efferent;(function(e){var t;(function(t){var i=e.Frontend.WebClient;var o=e.Frontend.WebClient.DOMUtils;class CreateCustomerForm{Create(e,t,n){var a=new Array;var r=document.createElement("div");o.AddClass(r,"section");var l=document.createElement("div");o.AddClass(l,"block");r["DataSection"]=l;var s=new i.Form(l,t[0],n);s.AddField(new i.Field(i.EFieldType.Group,"",{text:"Create organization"},{},[]));s.AddField(new i.Field(i.EFieldType.Label,"customerName",{text:"Customer name",width:160,colon:true},{display:"inline-block"},[]));s.AddField(new i.Field(i.EFieldType.Textbox,"inputCustomerName",{id:"IdCustomerName",width:270,newline:true},{},[]));s.AddField(new i.Field(i.EFieldType.Label,"region",{text:"Region",width:160,colon:true},{display:"inline-block"},[]));s.AddField(new i.Field(i.EFieldType.SelectBox,"regionSelect",{id:"idRegionSelect",newline:true},{},[]));s.AddField(new i.Field(i.EFieldType.Label,"legalName",{text:"Legal name",width:160,colon:true},{display:"inline-block"},[]));s.AddField(new i.Field(i.EFieldType.Textbox,"inputLegalName",{id:"IdLegalName",width:270,newline:true},{},[]));s.AddField(new i.Field(i.EFieldType.Label,"contactName",{text:"Contact name",width:160,colon:true},{display:"inline-block"},[]));s.AddField(new i.Field(i.EFieldType.Textbox,"inputContactName",{id:"IdContactName",width:270,newline:true},{},[]));s.AddField(new i.Field(i.EFieldType.Label,"contacLasttName",{text:"Contact last name",width:160,colon:true},{display:"inline-block"},[]));s.AddField(new i.Field(i.EFieldType.Textbox,"inputContactLastName",{id:"IdContactLastName",width:270,newline:true},{},[]));s.AddField(new i.Field(i.EFieldType.Label,"contactEmail",{text:"Contact email",width:160,colon:true},{display:"inline-block"},[]));s.AddField(new i.Field(i.EFieldType.Textbox,"inputContactEmail",{id:"IdContactEmail",width:270,newline:true},{},[]));s.AddField(new i.Field(i.EFieldType.Label,"contactPhone",{text:"Contact phone",width:160,colon:true},{display:"inline-block"},[]));s.AddField(new i.Field(i.EFieldType.Textbox,"inputContactPhone",{id:"IdContactPhone",width:270,newline:true},{},[]));s.AddField(new i.Field(i.EFieldType.Label,"contactAddress",{text:"Contact address",width:160,colon:true},{display:"inline-block"},[]));s.AddField(new i.Field(i.EFieldType.Textbox,"inputContactAddress",{id:"IdContactAddress",width:270,newline:true},{},[]));s.AddField(new i.Field(i.EFieldType.Label,"city",{text:"City",width:160,colon:true},{display:"inline-block"},[]));s.AddField(new i.Field(i.EFieldType.Textbox,"inputCity",{id:"IdCity",width:270,newline:true},{},[]));s.AddField(new i.Field(i.EFieldType.Label,"state",{text:"State",width:160,colon:true},{display:"inline-block"},[]));s.AddField(new i.Field(i.EFieldType.Textbox,"inputState",{id:"IdState",width:270,newline:true},{},[]));s.AddField(new i.Field(i.EFieldType.Label,"postalCode",{text:"Postal code",width:160,colon:true},{display:"inline-block"},[]));s.AddField(new i.Field(i.EFieldType.Textbox,"inputPostalCode",{id:"IdPostalCode",width:270,newline:true},{},[]));s.AddField(new i.Field(i.EFieldType.Label,"country",{text:"Country",width:160,colon:true},{display:"inline-block"},[]));s.AddField(new i.Field(i.EFieldType.Textbox,"inputCountry",{id:"IdCountry",value:"United States of America",width:270,newline:true},{},[]));s.AddField(new i.Field(i.EFieldType.Label,"ipAddress",{text:"IP address *",width:160,colon:true},{display:"inline-block"},[]));s.AddField(new i.Field(i.EFieldType.Textbox,"inputIpAddress",{id:"IdIpAddress",width:270,newline:true},{},[]));s.AddField(new i.Field(i.EFieldType.Label,"application",{text:"Application",width:160,colon:true},{display:"inline-block"},[]));s.AddField(new i.Field(i.EFieldType.Textbox,"inputApplication",{id:"IdApplication",value:"eVue",width:270,newline:true},{},[]));s.AddField(new i.Field(i.EFieldType.Button,"BtnCreateCustomer",{id:"IdCreateCustomer",text:"Create org."},{"margin-right":"10px","margin-bottom":"10px"},["green","inline"],t[0].actionBtnCreateCustomer));s.Render();r.appendChild(l);e.appendChild(r);a.push(r);return a}}t.CreateCustomerForm=CreateCustomerForm})(t=e.PlatformClient||(e.PlatformClient={}))})(Efferent||(Efferent={}));var Efferent;(function(e){var t;(function(t){var i=e.Frontend.WebClient;var o=e.Frontend.WebClient.DOMUtils;class UserProfile{Create(e,t,n){var a=new Array;var r=document.createElement("div");o.AddClass(r,"section");var l=document.createElement("div");o.AddClass(l,"block");r["Role"]=l;var s=new i.Form(l,t[0],n);s.AddField(new i.Field(i.EFieldType.Group,"",{text:"Update user profile"},{},[]));s.AddField(new i.Field(i.EFieldType.HumanName,"HumanName",{text:"Human name container"},{},[]));s.AddField(new i.Field(i.EFieldType.Label,"phoneNumber",{text:"Phone number",width:130,colon:true},{},["inline"]));s.AddField(new i.Field(i.EFieldType.SelectBox,"selectCountryCodes",{options:t[0].optionsCountryCodes,values:t[0].valuesCountryCodes,value:"1"},{"min-width":"0px"},[]));s.AddField(new i.Field(i.EFieldType.Textbox,"phoneNumberInput",{newline:true,width:250},{width:"204px"},[]));s.AddField(new i.Field(i.EFieldType.Label,"email",{text:"Contact email",width:130,colon:true},{},["inline"]));s.AddField(new i.Field(i.EFieldType.Textbox,"emailInput",{newline:true,readonly:true,width:250},{},[]));s.AddField(new i.Field(i.EFieldType.Button,"updateProfile",{text:"Update",id:"updateProfile"},{},["green"],t[0].actionUpdateProfile));s.Render();r.appendChild(l);e.appendChild(r);a.push(r);return a}}t.UserProfile=UserProfile})(t=e.PlatformClient||(e.PlatformClient={}))})(Efferent||(Efferent={}));var Efferent;(function(e){var t;(function(t){var i=e.Frontend.WebClient;var o=e.Frontend.WebClient.DOMUtils;class UserRoles{Create(e,t,n){var a=new Array;var r=document.createElement("div");o.AddClass(r,"section");var l=document.createElement("div");o.AddClass(l,"block");r["Role"]=l;var s=new i.Form(l,t[0],n);s.AddField(new i.Field(i.EFieldType.Group,"",{text:""},{},[]));s.AddField(new i.Field(i.EFieldType.Label,"txtRole",{text:"Role Name",width:110,colon:true},{width:"120px"},["inline"]));s.AddField(new i.Field(i.EFieldType.Textbox,"inputRole",{value:t[0].roleName,width:270,newline:true},{width:"330px"},[]));s.AddField(new i.Field(i.EFieldType.Label,"txtFunctions",{text:"Functions",width:110,colon:true},{"vertical-align":"top"},["inline"]));s.AddField(new i.Field(i.EFieldType.CheckboxList,"checkboxListRolesFuncts",{id:"listFunctionsR"},{width:"440px",height:"320px",margin:"0 0 0 10px",display:"inline-block"},[]));s.AddField(new i.Field(i.EFieldType.NewLine,"null",{space:false},{},[]));s.AddField(new i.Field(i.EFieldType.Button,"BtnOkRole",{text:"Ok"},{margin:"0"},["green","inline"],t[0].actionBtnOk));s.AddField(new i.Field(i.EFieldType.Button,"BtnCancelRole",{text:"Cancel"},{margin:"0 0 0 10px"},["red","inline"],t[0].actionBtnCancel));s.Render();r.appendChild(l);e.appendChild(r);a.push(r);return a}}t.UserRoles=UserRoles})(t=e.PlatformClient||(e.PlatformClient={}))})(Efferent||(Efferent={}));var Efferent;(function(e){var t;(function(t){var i=e.Frontend.WebClient;var o=e.Frontend.WebClient.DOMUtils;class CreateDeviceForm{Create(e,t,n){var a=new Array;var r=document.createElement("div");o.AddClass(r,"section");var l=document.createElement("div");o.AddClass(l,"block");r["DataSection"]=l;var s=new i.Form(l,t[0],n);s.AddField(new i.Field(i.EFieldType.Group,"",{text:"Create device"},{},[]));s.AddField(new i.Field(i.EFieldType.Label,"legalName",{text:"Legal name",width:160,colon:true},{display:"inline-block"},[]));s.AddField(new i.Field(i.EFieldType.Textbox,"inputLegalName",{id:"IdLegalName",width:270,newline:true},{},[]));s.AddField(new i.Field(i.EFieldType.Label,"ipAddress",{text:"IP address",width:160,colon:true},{display:"inline-block"},[]));s.AddField(new i.Field(i.EFieldType.Textbox,"inputIpAddress",{id:"IdIpAddress",width:270,newline:true},{},[]));s.AddField(new i.Field(i.EFieldType.Label,"branchName",{text:"Branch name",width:160,colon:true},{display:"inline-block"},[]));s.AddField(new i.Field(i.EFieldType.Textbox,"inputBranchName",{id:"IdBranchName",width:270,newline:true},{},[]));s.AddField(new i.Field(i.EFieldType.Button,"BtnCreateDevice",{id:"IdCreateDevice",text:"Create device"},{"margin-right":"10px","margin-bottom":"10px"},["green","inline"],t[0].actionBtnCreateDevice));s.Render();r.appendChild(l);e.appendChild(r);a.push(r);return a}}t.CreateDeviceForm=CreateDeviceForm})(t=e.PlatformClient||(e.PlatformClient={}))})(Efferent||(Efferent={}));var Efferent;(function(e){var t;(function(t){var i=e.Frontend.WebClient;var o=e.Frontend.WebClient.DOMUtils;class CreateUserForm{Create(e,t,n){var a=new Array;var r=document.createElement("div");o.AddClass(r,"section");var l=document.createElement("div");o.AddClass(l,"block");r["MailSection"]=l;var s=new i.Form(l,t[0],n);s.AddField(new i.Field(i.EFieldType.Group,"",{text:"Add practitioner"},{},[]));s.AddField(new i.Field(i.EFieldType.Label,"labelEmail",{text:"Email",width:50},{display:"inline-block"},[]));s.AddField(new i.Field(i.EFieldType.Textbox,"inputEmail",{id:"inputEmail",newline:true,width:270},{},[]));s.AddField(new i.Field(i.EFieldType.Label,"labelRole",{text:"Role",width:50},{display:"inline-block"},[]));s.AddField(new i.Field(i.EFieldType.SelectBox,"selectRole",{options:"",values:"",value:"",newline:true},{},[]));s.AddField(new i.Field(i.EFieldType.Button,"BtnCreateUser",{text:"Proceed"},{},["green"],t[0].actionBtnCreateUser));s.Render();r.appendChild(l);var l=document.createElement("div");o.AddClass(l,"block");r["ManagePractitionersSection"]=l;var s=new i.Form(l,t[0],n);s.AddField(new i.Field(i.EFieldType.Group,"",{text:"Manage practitioners"},{},[]));s.AddField(new i.Field(i.EFieldType.Text,"",{text:"Assign roles / Add or remove app tags / Delete practitioners",newline:true},{},[]));s.AddField(new i.Field(i.EFieldType.Button,"BtnManagePractitioner",{text:"Go to list"},{},["green"],t[0].actionBtnManagePractitioner));s.Render();r.appendChild(l);e.appendChild(r);a.push(r);return a}}t.CreateUserForm=CreateUserForm})(t=e.PlatformClient||(e.PlatformClient={}))})(Efferent||(Efferent={}));var Efferent;(function(e){var t;(function(t){var i=e.Frontend.WebClient;class AdminRolesView extends i.SubView{constructor(o,n,a){super(o,n,"PlatformLanguageJson");this.Platform=n;this.ResourceBag=t.ResourceBag;this.Platform.LanguageManager.AddDictionary("{Efferent.PlatformClient.ResourceBag.PlatformLanguageJson}","Efferent.PlatformClient",e.PlatformClient.ResourceBag.PlatformLanguageJson[this.Platform.LanguageManager.CurrentLanguage]);this.formContainer=document.createElement("div");this.BodySection.appendChild(this.formContainer);const r=new e.ClientViews.FormView.FormView(this.formContainer,n,null,a,null,this);this.ResizeListeners.push(new i.ResizeStructure(this.constructor.name.toLowerCase(),this,this.constructor.name));this.OnWindowResize(0,0)}CloseSubView(){super.CloseSubView()}SetButtons(){super.SetButtons([],(()=>{this.Platform.CurrentView.CloseActionsConfig()}))}OnWindowResize(e,t,i){var o=this.BodySection.clientWidth;this.formContainer.style.width=o+"px";this.formContainer.style.height="100%";super.OnWindowResize(e,t,i)}}t.AdminRolesView=AdminRolesView})(t=e.PlatformClient||(e.PlatformClient={}))})(Efferent||(Efferent={}));var Efferent;(function(e){var t;(function(t){var i=e.Frontend.WebClient;var o=e.Frontend.WebClient.HttpUtils;class CacheConnection{constructor(e,t){this.timerControlCacheIsOff=null;this.isDnsDetected=false;this.platform=e;this.timeoutGetToken=15500;this.portIpCache=8889;this.BlockTokenRequest=false;this.IsActivatingCache=false;this.ServiceUrlCache=this.platform.GetSetting("urlLocalRepo");this.ServiceIpCache=sessionStorage["serviceIpCache"]||"";this.OfflineMode=t;if(this.OfflineMode){this.CacheToken=sessionStorage["tokenCache"];this.ServiceUrlCache=i.PlatformContext.PlatformUri}else{if(sessionStorage["tokenCache"]===undefined||sessionStorage["tokenCache"]===null||sessionStorage["tokenCache"]===""){var o=this.platform.GetSetting("automaticSelection");if(o!==null&&o!==undefined&&i.Utils.StrToBool(o)===true){this.ConnectToAutomaticDns()}else{var n=i.Loader.Show("Getting access to local cache");this.GetToken((()=>{i.Loader.Hide(n.getAttribute("id"))}))}}}}SearchDns(){var e=this.platform.GetSetting("automaticSelection");if(e!==null&&e!==undefined&&i.Utils.StrToBool(e)===true){if(!this.isDnsDetected){try{clearInterval(this.intervalDnsSearching)}catch(e){}this.intervalDnsSearching=setInterval((()=>{if(!this.isDnsDetected)this.ConnectToAutomaticDns()}),3e4)}}}GetIntervalDnsSearching(){return this.intervalDnsSearching}ConnectToAutomaticDns(){this.ServiceUrlCache="";this.isDnsDetected=false;this.platform.GetLocalDeviceSmartLink((e=>{try{e=JSON.parse(e);if(e.found){try{clearInterval(this.intervalDnsSearching)}catch(e){}this.isDnsDetected=true;var t=e.dns;var o=e.ip;this.ServiceUrlCache=t!==null&&i.Utils.IsURL(t)?t:"";this.ServiceIpCache=o;if(this.ServiceUrlCache!==""||this.ServiceIpCache!==""){this.platform.SetSetting(40,"urlLocalRepo",this.ServiceUrlCache);if(this.platform.ShowSettings){var n=i.Form.GetFieldFromForms(this.platform.SettingsSubView.Pane.DataA,"urlLocalXC");var a=n.htmlElement["field"];var r=n.htmlElement["binding"];n.htmlElement.value=this.ServiceUrlCache;a.UpdateValue(r,this.ServiceUrlCache)}if(!this.platform.ListDNSUnBlockedForSLConnection[this.ServiceUrlCache]){this.platform.ToogleMessageAutomaticConnectToSL(true)}}}}catch(e){i.Utils.DebugConsoleLog("error getting the automatic dns "+e)}finally{this.GetToken(null)}}))}ActivateCache(e){if(this.OfflineMode)return;if(this.ServiceIpCache===""||(this.ServiceIpCache===null||this.ServiceIpCache==="")){i.Toaster.ShowToast("The cache server ip is invalid.",i.Colors.Orange,20);return}if(e!==undefined&&e)i.Loader.Show();this.IsActivatingCache=true;this.BlockTokenRequest=false;var t=this.platform.GetSetting("localRepoActive");if(e!==undefined&&e||(e===undefined||e!==undefined&&!e)&&(t!==undefined&&i.Utils.StrToBool(t))){if(t!==undefined&&i.Utils.StrToBool(t)){var o="https://"+this.ServiceIpCache+":"+this.portIpCache;if(o!==""&&o!=="undefined"){var changeOfflineMode=()=>{i.Loader.HideAll();if(this.CacheToken!==undefined&&this.CacheToken!==null&&this.CacheToken!==""){i.Toaster.ShowToast("Working in offline mode",i.Colors.Orange,20);var t=i.PlatformContext.PlatformUri;i.Toaster.ShowToast("Offline mode enabled",i.Colors.BelizeHole,3);var n="";if(e!==undefined){this.OfflineMode=e;n="&isForce=true"}else{this.OfflineMode=true}window.location.replace(o+"/"+"login.html?username="+sessionStorage["userEmail"]+"&sha="+sessionStorage["passwordUser"]+"&offline=active&platformUriOnline="+t+"&authorizationOnline="+sessionStorage["token"]+"&cachews=inactive"+"&app="+sessionStorage["application"]+"&org="+sessionStorage["organizationId"]+n)}else{this.platform.CacheTries++;i.Loader.HideAll();this.platform.ShowSwitchMessageToCacheMode(null)}};if(this.CacheToken!==undefined&&this.CacheToken!==null&&this.CacheToken!=="")changeOfflineMode();else{this.GetToken((()=>{changeOfflineMode()}))}}else{i.Toaster.ShowToast("Please configure offline mode.",i.Colors.Orange,20);i.Loader.HideAll();this.platform.CurrentView.SetInitialStatus()}}else{i.Toaster.ShowToast("Please configure offline mode.",i.Colors.Orange,20);i.Loader.HideAll();this.platform.CurrentView.SetInitialStatus()}}this.IsActivatingCache=false}ActivateIntervalCacheController(){if(this.timerControlCacheIsOff!==null&&this.timerControlCacheIsOff!==true)return;this.timerControlCacheIsOff=false;var e=setInterval((()=>{try{var t=sessionStorage["RepositoryOnlineBaseUri"]+"/platform/sync";var n={};n["Authorization"]="Bearer "+sessionStorage["authorizationOnline"];o.AjaxCall(t,"GET",n,null,((t,o)=>{if(!i.Utils.StrToBool(sessionStorage["OfflineForced"])){clearInterval(e);this.timerControlCacheIsOff=true;this.platform.ShowSwitchMessageToCacheMode(false)}}),((t,o)=>{if(t!==0){if(!i.Utils.StrToBool(sessionStorage["OfflineForced"])){clearInterval(e);this.timerControlCacheIsOff=true;this.platform.ShowSwitchMessageToCacheMode(false)}}}))}catch(t){i.Utils.DebugConsoleLog("Cache timer controler failed");clearInterval(e);this.timerControlCacheIsOff=true}}),3e4)}DeactivateCache(e){var t;if(sessionStorage["RepositoryOnlineBaseUri"]!==undefined&&sessionStorage["RepositoryOnlineBaseUri"]!==""){var o=sessionStorage["RepositoryOnlineBaseUri"];var n=sessionStorage["userEmail"];var a=sessionStorage["passwordUser"];sessionStorage.removeItem("RepositoryOnlineBaseUri");this.CacheToken=null;i.Toaster.ShowToast("Offline mode disabled",i.Colors.BelizeHole,3);if(e!==undefined){this.OfflineMode=e;sessionStorage["OfflineForced"]=false}else{this.OfflineMode=false}t=sessionStorage["standAloneOnline"];this.platform.Logout((()=>{if(t)location.replace(o+"/"+"login.html?username="+n+"&sha="+a+"&online=active&cachews=inactive");else window.location.replace(o+"/"+"login.html?username="+n+"&sha="+a+"&online=active")}))}else{sessionStorage.removeItem("RepositoryOnlineBaseUri");t=sessionStorage["standAloneOnline"];if(t)location.replace("login.html?cachews=inactive");else location.replace("login.html")}}GetToken(e){if(!this.BlockTokenRequest&&this.platform.GetSetting("localRepoActive")!==undefined&&this.platform.GetSetting("localRepoActive")==="true"&&i.Utils.IsURL(this.ServiceUrlCache)&&sessionStorage["userEmail"].match("device")===null){var t=new URL(this.ServiceUrlCache).hostname;var o=this.ServiceUrlCache+"/platform/login?emailAddress="+sessionStorage["userEmail"]+"&password="+sessionStorage["passwordUser"]+"&dns="+t;i.HttpUtils.AjaxCall(o,"GET",null,null,((t,o)=>{var n=JSON.parse(t.response);var a=new i.JwtParser(n["id_token"]);var r=a.Payload["ip"];if(r){this.CacheToken=sessionStorage["tokenCache"]=n["id_token"];this.ServiceIpCache=sessionStorage["serviceIpCache"]=r;this.authorize(e)}else{i.Toaster.ShowToast("The cache address is invalid",i.Colors.BelizeHole,3)}}),((t,i)=>{this.BlockTokenRequest=true;setTimeout((()=>{this.BlockTokenRequest=false}),15*60*1e3);if(e!==undefined&&e!==null){e()}}),null,null,null,null,null,this.timeoutGetToken,(()=>{this.BlockTokenRequest=true;setTimeout((()=>{this.BlockTokenRequest=false}),15*60*1e3)}))}else{if(e!==undefined&&e!==null)e()}}authorize(e){var t=new XMLHttpRequest;t.onreadystatechange=()=>{if(t.readyState===XMLHttpRequest.DONE){if(t.status===200){var i=JSON.parse(t.response);this.CacheToken=sessionStorage["tokenCache"]=i["access_token"];if(e!==undefined&&e!==null)e()}else{if(e!==undefined&&e!==null)e()}}};var i=this.ServiceUrlCache+"/platform/authorize?org="+sessionStorage["organizationId"]+"&app="+sessionStorage["application"];t.open("GET",i,true);t.setRequestHeader("Authorization","Bearer "+this.CacheToken);t.send()}}t.CacheConnection=CacheConnection})(t=e.PlatformClient||(e.PlatformClient={}))})(Efferent||(Efferent={}));var Efferent;(function(e){var t;(function(t){var i=e.Frontend.WebClient;class Configuration{constructor(e){this.Main=e}GetConfigurationParams(){try{try{this.QualityMode=this.Main.GetSetting("QualityMode")||"Low";var e=sessionStorage["role"].split(",");if(e.some((e=>e.toLowerCase()==="patient"))){this.QualityMode="Low"}else{if(this.Main.GetSetting("highResIsActive")){var t=i.Utils.StrToBool(this.Main.GetSetting("highResIsActive"));if(t)this.QualityMode="Mixed"}}}catch(e){this.QualityMode="Low"}try{this.Tags=JSON.parse(i.Utils.DecodeBase64(this.Main.GetSetting("Tags")))}catch(e){this.Tags={}}}catch(e){i.Utils.DebugConsoleLog("ConfigParams Get: "+e)}}}t.Configuration=Configuration})(t=e.PlatformClient||(e.PlatformClient={}))})(Efferent||(Efferent={}));var Efferent;(function(e){var t;(function(t){var i=e.Frontend.WebClient;var o=e.Frontend.WebClient.DOMUtils;var n=e.Frontend.WebClient.Utils;class CustomToolbarHandler{constructor(e){this.headerController=e;this.toolbarOrderPreference={itemsCount:0,historyActions:[]};this.loadedPreferences=false;this.StudyType="image"}SetMainToolbar(e){var t;this.mainToolbar=e;const onMainToolbarChanged=()=>{const e=this.queryItems(this.mainToolbar);if(this.loadedPreferences){this.mainToolbar.removeEventListener("DOMSubtreeModified",onMainToolbarChanged,false);return}if(e.length===this.toolbarOrderPreference.itemsCount){this.originalOrder=this.getOriginalOrder();this.mainToolbar.removeEventListener("DOMSubtreeModified",onMainToolbarChanged,false);this.LoadPreferences(this.mainToolbar);this.loadedPreferences=true}};const onMainToolbarMutation=e=>{const t=e.filter((e=>{const t=+e.oldValue;const i=+e.target.getAttribute("data-numbuttons");return e.attributeName==="data-numbuttons"&&t!==i})).pop();if(t){this.StudyType=this.GetStudyType();this.LoadPreferences(this.mainToolbar);this.mainToolbar.removeEventListener("DOMSubtreeModified",onMainToolbarChanged,false)}};this.toolbarOrderPreference=this.parseToolbarOrderPreference();if(((t=this.toolbarOrderPreference)===null||t===void 0?void 0:t.itemsCount)>0)this.mainToolbar.addEventListener("DOMSubtreeModified",onMainToolbarChanged,false);else{this.toolbarOrderPreference={itemsCount:0,historyActions:[]}}const i=new MutationObserver(onMainToolbarMutation.bind(this));const o=setTimeout((()=>{i.observe(this.mainToolbar,{attributes:true,attributeOldValue:true});clearTimeout(o)}),2e3)}GetStudyType(){const e=Array.from(this.mainToolbar.querySelectorAll(".toolbarButton"));const t=e.filter((e=>{var t;return(t=e.innerText)===null||t===void 0?void 0:t.toLocaleLowerCase().includes("play")}));const i=t.length>0?t[0]:null;return i&&o.IsDisplay(i)?"mp4":"image"}Activate(){var e;const t=document.body;if(!t.getAttribute(CustomToolbarHandler.ATTR_HAS_TOOLBAR_LISTENER))t.setAttribute(CustomToolbarHandler.ATTR_HAS_TOOLBAR_LISTENER,"true");(e=t.querySelector(".bodySection"))===null||e===void 0?void 0:e.classList.add("relativepanel","blockedByEditToolbarPane")}Deactivate(){var e;if(document.body.getAttribute(CustomToolbarHandler.ATTR_HAS_TOOLBAR_LISTENER)){document.body.removeAttribute(CustomToolbarHandler.ATTR_HAS_TOOLBAR_LISTENER)}(e=document.querySelector(".bodySection"))===null||e===void 0?void 0:e.classList.remove("relativepanel","blockedByEditToolbarPane")}SetupDragEventsOnToolbar(){const e=this.queryItems(this.headerController.ClonedToolbar);const t=this.getFlyoutToolbar();const i=this.headerController.ClonedToolbar.querySelectorAll(".mainToolbar img");Array.from(i).forEach((e=>e.ondragstart=()=>false));e.forEach((i=>{const n=new Hammer(i);n.get("pan").set({direction:Hammer.DIRECTION_ALL,threshold:0,pointers:0});n.on("panstart panmove panend pancancel press pressup",(n=>{switch(n.type){case"panstart":const a=i.getBoundingClientRect();o.SetBoundRectangle(t,a);this.addContentToFlyout(t,i);i.style.outline="none";t.style.display="flex";t.style.cursor="grab";break;case"panmove":i.style.cursor="grab";t.style.cursor="grabbing";t.style.top=n.center.y-20+"px";t.style.left=n.center.x-12+"px";break;case"panend":const r=o.DectectClosestItem(e,n.center);if(r){if(o.IsBeforeElement(r,t)){r.parentNode.insertBefore(i,r);this.AddToHistory(i.innerText,r.innerText,true)}else{o.InsertAfter(i,r);this.AddToHistory(i.innerText,r.innerText,false)}}t.innerHTML="";t.style.display="none";break;case"pancancel":t.innerHTML="";t.style.display="none";break;case"press":i.style.outline="1px solid cyan";break;case"pressup":i.style.outline="none";break}}))}))}SavePreferences(){const e=this.queryItems(this.mainToolbar);if(this.toolbarOrderPreference.itemsCount===0){this.originalOrder=this.getOriginalOrder();i.LocalStorage.Set("originalToolbarOrder",JSON.stringify(this.originalOrder))}this.toolbarOrderPreference.itemsCount=e.length;const t=JSON.stringify(this.toolbarOrderPreference);this.headerController.SaveToolbarOrderPreference(n.EncodeBase64(t));this.LoadPreferences(this.headerController.MainToolbar)}ResetPreferences(){this.toolbarOrderPreference.historyActions.length=0;this.toolbarOrderPreference.itemsCount=0;const e=JSON.stringify(this.toolbarOrderPreference);this.headerController.SaveToolbarOrderPreference(n.EncodeBase64(e));this.setOriginalOrder()}LoadPreferences(e){const t=this.parseToolbarOrderPreference();if(t===null||t===void 0?void 0:t.historyActions){if(!e.closest("body"))e=document.querySelector(".mainToolbar");this.reorganizeItems(e,t)}}getOriginalOrder(){const e=this.queryItems(this.mainToolbar);const t={};e.forEach((e=>{var i;const o=e.parentElement.dataset.groupname;if(!(((i=t[o])===null||i===void 0?void 0:i.length)>0))t[o]=[];t[o].push(e.innerText)}));i.LocalStorage.Set("originalToolbarOrder",JSON.stringify(t));return t}setOriginalOrder(){if(!this.originalOrder){const e=i.LocalStorage.Get("originalToolbarOrder");if(e){const t=JSON.parse(e);if(t)this.originalOrder=t}}const e=Object.keys(this.originalOrder);const t=document.querySelector(".mainToolbar");const o=this.queryItems(t);const findItemInToolbar=e=>{let t=null;o.forEach((i=>{if(i.innerText===e)t=i}));return t};e.forEach((e=>{var i;const o=t.querySelector(`[data-groupName="${e}"]`);if(((i=this.originalOrder[e])===null||i===void 0?void 0:i.length)>0){this.originalOrder[e].forEach((e=>{const t=findItemInToolbar(e);if(t)o===null||o===void 0?void 0:o.appendChild(t)}))}}))}parseToolbarOrderPreference(){const e=this.headerController.GetToolbarOrderPreference();if(e){const t=n.DecodeBase64(e);if(t){const e=JSON.parse(t);if(e)return e}}return null}queryItems(e){if(e){const t=new Set;const i=e.getElementsByClassName("toolbarButton");const n=e.getElementsByClassName("toolbarDrop");const addElement=e=>{if(o.IsDisplay(e))t.add(e)};Array.from(i).forEach(addElement);Array.from(n).forEach(addElement);return Array.from(t)}return[]}AddToHistory(e,t,i){const o=this.toolbarOrderPreference.historyActions.findIndex((t=>t.newElement===e));if(o>-1)this.toolbarOrderPreference.historyActions.splice(o,1);this.toolbarOrderPreference.historyActions.push({newElement:e,element:t,isBefore:i})}getFlyoutToolbar(){let e=document.querySelector(".flyout-toolbar");if(!e){e=document.createElement("div");e.classList.add("flyout-toolbar");e.style.position="absolute";document.body.appendChild(e)}return e}addContentToFlyout(e,t){const i=document.createElement("div");i.className="toolbarButton";i.innerHTML=t.innerHTML;e.appendChild(i)}reorganizeItems(e,t){const i=t.historyActions;let n=this.queryItems(e);if(!n.length)return;let a=new Map;n.forEach((e=>{a.set(e.innerText,e)}));if(n.length!==t.itemsCount)return;for(let e=0;e<i.length;e++){const t=i[e].element;const n=t.replace(/\n/g,"");const r=i[e].newElement;const l=r.replace(/\n/g,"");const s=a.get(t)||a.get(n);const d=a.get(r)||a.get(l);if(s&&d){if(i[e].isBefore)s.parentNode.insertBefore(d,s);else o.InsertAfter(d,s)}}}}CustomToolbarHandler.ATTR_HAS_TOOLBAR_LISTENER="has-toolbar-listeners";t.CustomToolbarHandler=CustomToolbarHandler})(t=e.PlatformClient||(e.PlatformClient={}))})(Efferent||(Efferent={}));var Efferent;(function(e){var t;(function(t){var i=e.Frontend.WebClient;class CustomerCreationController{CreateDeviceSection(t){var o=document.createElement("div");o.classList.add("marginLeft");t.appendChild(o);var n={};n["actionBtnCreateDevice"]=e=>{var t={};t["legalName"]=i.Form.GetFieldFromForms(n,"inputLegalName").htmlElement.value;t["ipAddress"]=i.Form.GetFieldFromForms(n,"inputIpAddress").htmlElement.value;t["branchName"]=i.Form.GetFieldFromForms(n,"inputBranchName").htmlElement.value;var o=i.PlatformContext.PlatformUri+"/platform/device";i.Loader.Show();i.Toaster.ShowToast("Creating device",i.Colors.Emerald,3);i.HttpUtils.AjaxCall(o,"POST",null,JSON.stringify(t),(()=>{i.Loader.HideAll();i.Toaster.ShowToast("Device created",i.Colors.Emerald,3)}),((e,t)=>{i.Loader.HideAll();i.Toaster.ShowToast(t.getResponseHeader("X-Error"),i.Colors.Alizarin,3)}))};(new e.PlatformClient.CreateDeviceForm).Create(o,[n])}CreateCustomerSection(t){var o=document.createElement("div");t.appendChild(o);var n={};n["actionBtnCreateCustomer"]=e=>{var t={};var o=i.Form.GetFieldFromForms(n,"regionSelect").htmlElement.selectedIndex;t["customerName"]=i.Form.GetFieldFromForms(n,"inputCustomerName").htmlElement.value;t["region"]=this.regions[o]["region"];t["regionAlias"]=this.regions[o]["alias"];t["legalName"]=i.Form.GetFieldFromForms(n,"inputLegalName").htmlElement.value;t["contactName"]=i.Form.GetFieldFromForms(n,"inputContactName").htmlElement.value;t["contactLastName"]=i.Form.GetFieldFromForms(n,"inputContactLastName").htmlElement.value;t["contactEmail"]=i.Form.GetFieldFromForms(n,"inputContactEmail").htmlElement.value;t["contactPhone"]=i.Form.GetFieldFromForms(n,"inputContactPhone").htmlElement.value;t["contactAddress"]=i.Form.GetFieldFromForms(n,"inputContactAddress").htmlElement.value;t["city"]=i.Form.GetFieldFromForms(n,"inputCity").htmlElement.value;t["state"]=i.Form.GetFieldFromForms(n,"inputState").htmlElement.value;t["postalCode"]=i.Form.GetFieldFromForms(n,"inputPostalCode").htmlElement.value;t["country"]=i.Form.GetFieldFromForms(n,"inputCountry").htmlElement.value;t["ipAddress"]=i.Form.GetFieldFromForms(n,"inputIpAddress").htmlElement.value;t["application"]=i.Form.GetFieldFromForms(n,"inputApplication").htmlElement.value;var a=i.PlatformContext.PlatformUri+"/platform/customer";if(t["ipAddress"]){i.Loader.Show();i.Toaster.ShowToast("Creating customer",i.Colors.Emerald,3);i.HttpUtils.AjaxCall(a,"POST",null,JSON.stringify(t),(e=>{var t;var o;if(e.status===200||e.status===201){t="Customer created";o=i.Colors.Emerald}i.Loader.HideAll();i.Toaster.ShowToast(t,o,3)}),((e,t)=>{i.Loader.HideAll();i.Toaster.ShowToast(t.getResponseHeader("X-Error"),i.Colors.Alizarin,3)}))}else{i.Toaster.ShowToast("The IP field is mandatory.",i.Colors.Orange,3)}};(new e.PlatformClient.CreateCustomerForm).Create(o,[n]);var a=i.Form.GetFieldFromForms(n,"regionSelect").htmlElement;this.fillRegions(a)}fillRegions(t){this.regions=[];var o=e.Frontend.WebClient.PlatformContext.PlatformUri+"/dicomweb/repositories";e.Frontend.WebClient.HttpUtils.AjaxCall(o,"GET",null,null,((e,i)=>{var o=e.responseText.split(";");for(var n=0;n<o.length;n++){var a=o[n].split(",");var r=document.createElement("option");r.text=a[0];r.value=a[1];r.selected=n===0;t.appendChild(r);this.regions.push({alias:a[0],region:a[1]})}}),(e=>{i.Loader.Hide();i.Toaster.ShowToast("Error retrieving the region list",i.Colors.BelizeHole,3)}))}}t.CustomerCreationController=CustomerCreationController})(t=e.PlatformClient||(e.PlatformClient={}))})(Efferent||(Efferent={}));var Efferent;(function(e){var t;(function(t){var i=e.Frontend.WebClient.DOMUtils;var o=e.Frontend.WebClient;class FunctionsList extends o.WorklistGrid{constructor(e){var t=document.createElement("div");i.AddClass(t,"worklistPane");var n=new o.WorklistColumn("Function",180,(()=>{}),o.EWorklistSort.None,o.EWorklistFilter.Up);var a=new o.WorklistColumn("Views",280,(()=>{}),o.EWorklistSort.None,o.EWorklistFilter.Up);var r=new Array;r.push(n);r.push(a);super(r);this.Worklist=t;this.Parent=e;var l=document.createElement("table");l.width="350px";l.setAttribute("class","workListTable");this.Table=l;var s=document.createElement("ul");s.setAttribute("class","workListUl");this.List=s;var d=document.createElement("thead");var c=document.createElement("tbody");this.THead=d;this.TBody=c;this.Table.appendChild(d);this.Table.appendChild(c);this.Worklist.appendChild(this.Table);this.Worklist.appendChild(this.List);this.Parent.appendChild(this.Worklist);this.THead.innerHTML=""}BuildTableHeader(){super.CreateHead(this.THead)}BuildBodyTable(e){var t=new Array;this.TBody.innerHTML="";this.From=1;this.PageSize=30;for(var i in e){if(e.hasOwnProperty(i)){var n=e[i];if(n instanceof Object){var a=new Array;a.push(new o.ItemCell(n["Function"]));a.push(new o.ItemCell(n["Views"]));var r=new o.WorklistRow(n,a,(e=>{if(this.SelectedEntities!==undefined)this.ActionClick(this.SelectedEntities[0]);else this.ActionClick(null)}),(e=>{}),this);t.push(r)}}}this.Rows=t;super.CreateBody(this.TBody,this.List,(()=>{}),(()=>{}));var l=this.Parent.clientHeight;this.Worklist.style.height=l+"px";this.Worklist.style.overflow="auto"}}t.FunctionsList=FunctionsList})(t=e.PlatformClient||(e.PlatformClient={}))})(Efferent||(Efferent={}));var Efferent;(function(e){var t;(function(t){var i=e.Frontend.WebClient.DOMUtils;var o=e.Frontend.WebClient.HttpUtils;var n=e.Frontend.WebClient;var a=e.ClientViews.CommonView;var r=e.Frontend.WebClient.Utils;var l=e.Frontend.SettingsClient;const{div:s,span:d,img:c,button:h}=i;class HeaderController{constructor(e){this.platform=e;this.userSectionController=new t.UserSectionController(e);this.userToolbarWidth=0;this.isOpenEditToolbar=false;this.customBarHandler=new t.CustomToolbarHandler(this)}GetHeight(){return this.toolbarSection.clientHeight}RebuildTagsMenu(t,o,r=false){const l=this.platform.CurrentSpec.GridTemplates[t.SpecView.TemplateId]["ResourceType"];const s=this.platform.CurrentSpec.DefaultTags.hasOwnProperty(l)?this.platform.CurrentSpec.DefaultTags[l]+",":"";let d=s;d+=this.platform.Configuration.Tags.hasOwnProperty(l)?this.platform.Configuration.Tags[l].replace(/"/g,""):"";const c=n.TagUtils.ParseTagRules(d);const h=[];h.push(["tags",a.ResourceBag.Icons8Tags32Png,e=>{this.toolbar.DeselectAllButtons();this.RebuildTagsMenu(t,o,false)}]);h.push(["editTag",a.ResourceBag.Icons8PriceTag327Png,e=>{this.toolbar.DeselectAllButtons();try{const e=t.ShareController.SharedFlyout;if(e!==null&&e!==undefined)e.style.display="none"}catch(e){}if(!i.IsDisplay(this.TagPane.Container.parentElement.parentElement)){this.TagPane.ShowSection()}else{this.TagPane.HideSection()}}]);let u;c.forEach(((e,t,o)=>{if(typeof e==="string"){h.push([e,"0",e=>{if(!this.platform.CurrentView.GetFhirEntities()||this.platform.CurrentView.GetFhirEntities().length===0){n.Toaster.ShowToast("Please select a record.",n.Colors.BelizeHole,3);i.FindNearestAncestor(e.srcEvent.srcElement,"toolbarMenu").style.display="none";return}const t=e.target.childNodes[0].nodeValue||e.target.innerText;a.TagController.AddTagToResource(this.platform.CurrentView,t,this.platform.CurrentView.GetFhirEntities(),(e=>{this.platform.CurrentView.OnTagChanged(e)}));this.toolbar.Groups[0].Buttons.forEach((e=>{if(e.Name==="tags"){e.Child.ButtonItems.forEach((e=>{if(e.Element.children&&e.Element.children.length>0){if(i.HasClass(e.Element.children[0],"activeTag"))i.RemoveClass(e.Element.children[0],"activeTag")}}))}}));i.FindNearestAncestor(e.srcEvent.srcElement,"toolbarMenu").style.display="none"}])}else if(typeof e==="object"){for(let t=0;t<e.length;t++){if(t===0)u="0-0";else if(t===e.length-1)u="0-2";else u="0-1";h.push([e[t],u,e=>{if(this.platform.CurrentView.GetFhirEntities()&&this.platform.CurrentView.GetFhirEntities().length>0){const t=e.target.childNodes[0].nodeValue||e.target.innerText;a.TagController.AddTagToResource(this.platform.CurrentView,t,this.platform.CurrentView.GetFhirEntities(),(e=>{this.platform.CurrentView.OnTagChanged(e)}));i.FindNearestAncestor(e.srcEvent.srcElement,"toolbarMenu").style.display="none"}else{n.Toolbar.HideAllMenus();n.Toaster.ShowToast("Please select a record",n.Colors.BelizeHole,3)}}])}}}));if(r){return h}else{this.toolbar.AddDynamicSubMenu(n.EToolbarButtonType.DropDown,h,this.platform.CurrentView.GetLanguageDictionary(),"common.1","tags",true,"tagMenuToolbar");this.appendActionToCustomTagInput();const t=this.toolbar.GetButton("Tags");if(t.Child!==undefined&&t.Child!==null){let e=false;const i=n.TagUtils.ParseTagRules(s).flat();const o=document.getElementById("defaultTagsContainer");const a=t.Child.ButtonItems.map((e=>e["Title"]));for(let n=0;n<a.length;n++){if(i.includes(t.Child.ButtonItems[n]["Title"])){o.appendChild(t.Child.ButtonItems[n].Element);if(!e)e=true}}if(!e){o.remove()}}const i=this.platform.CurrentView.GetFhirEntities();const o=n.TagUtils.GetTags(i[0]);const a=n.TagUtils.SelectTagToMenu(i);const r=o.filter((e=>a.indexOf(e)<0));e.ClientViews.CommonView.TagController.CreateExtraTags(this.platform.CurrentView,r,i)}}ManageButtonAdmin(e){e=true;const t=this.platform.ApplicationTags.hasOwnProperty("dummyPatient");this.userSectionController.AdjustPosition();try{const i=document.getElementsByClassName("topBar")[0];if(i===undefined||getComputedStyle(i,null).display==="none"){const i=document.getElementById("AdminContentBox");const o=document.getElementById("LogoutUserHeader");const n=document.getElementById("AdminUserHeader");const a=document.getElementById("infoUserHeader");if(t){n.style.display="none"}if(o.clientWidth!==0)this.userToolbarWidth=o.clientWidth;if(document.documentElement.clientWidth<1100||e){i.appendChild(this.UserToolbar.Element);this.UserToolbar.Element.style.marginBottom="0px";this.UserToolbar.Element.style.cssFloat="right";i.appendChild(a);o.style.display="none";n.style.display=t?"none":"block"}else{const e=this.toolbar.Element.clientWidth+this.userToolbarWidth;if(document.documentElement.clientWidth-20<=e){this.ManageButtonAdmin(true)}else{o.parentNode.insertBefore(a,o);a.style.position="absolute";this.UserToolbar.Element.style.marginBottom="10px";this.UserToolbar.Element.style.cssFloat="unset";o.appendChild(this.UserToolbar.Element);o.style.display="block";n.style.display="none";i.style.display="none"}}}}catch(e){}}TogglePrimaryNavigationButtons(){const e=this.platform.CurrentSpec.GetDefaultView().Id;const t=o.GetUrlParameter("view");this.toolbar.HideButton("main.1","home");this.toolbar.HideButton("main.1","back");if(this.platform.BrowsingHistory.length>0){this.toolbar.ShowButton("main.1","back");if(this.platform.BrowsingHistory.length>1)this.toolbar.ShowButton("main.1","home")}if(e!==t&&t!==""&&this.platform.BrowsingHistory.length===0){this.toolbar.ShowButton("main.1","home")}}CreateMainToolbar(){const e="User";this.toolbarSection=s({id:"toolbarHeader"});this.logoutSection=s({id:"LogoutUserHeader",style:{display:"none"}});this.DivAdminContentBox=s({id:"AdminContentBox"});this.DivAdminContainer=s({id:"AdminButton",className:"logoutButton toolbarDrop",children:[d({innerHTML:e}),c({className:"icon",src:n.ResourceBag.Icons8AdminSettingsMale32Png})]});this.DivAdminContainer.addEventListener("click",(()=>{this.ToggleAdminViewContainer();const e=this.DivAdminContentBox.getElementsByClassName("toolbarItemUserMenu");for(const t in e){if(e.hasOwnProperty(t)){const i=e[t];if(i.getAttribute("eventContainerAdminBoxLoaded")!=="active"){i.setAttribute("eventContainerAdminBoxLoaded","active");const e=new Hammer(i);e.on("tap",(e=>{if(getComputedStyle(this.DivAdminContentBox,null).display!=="none")this.ToggleAdminViewContainer()}))}}}}));this.adminSection=s({id:"AdminUserHeader",children:[this.DivAdminContainer,this.DivAdminContentBox]});this.HeaderSection=s({className:"headerSection",style:{display:"flex"},children:[this.DivEditToolbar=this.buildButtons(),s({className:"headerContentSection",style:{display:"flex",background:"var(--color-background-secondary)"},children:[this.toolbarSection,this.logoutSection,this.adminSection]})]});this.toolbar=new n.Toolbar(this.platform);this.platform.ResizeListeners.push(new n.ResizeStructure(this.toolbar.constructor.name.toLowerCase(),this.toolbar,this.platform.constructor.name));this.toolbar.Create(this.toolbarSection);this.customBarHandler.SetMainToolbar(this.toolbar.Element);this.UserToolbar=new n.Toolbar(this.platform);this.platform.ResizeListeners.push(new n.ResizeStructure(this.UserToolbar.constructor.name.toLowerCase(),this.UserToolbar,this.platform.constructor.name));this.UserToolbar.Create(this.logoutSection,false,"userSectionNav");this.TogglePrimaryNavigationButtons();this.userSectionController.Initialize();this.logoutSection.appendChild(this.userSectionController.DataUserSection);return this.toolbar}SetMainToolbar(){this.MainToolbar=this.toolbar.Element;this.customBarHandler.SetMainToolbar(this.toolbar.Element)}ToggleAdminViewContainer(e){if(e){this.DivAdminContentBox.style.display="none";this.DivAdminContainer.classList.remove("selected")}else{if(this.DivAdminContentBox.style.display!=="block"){this.DivAdminContentBox.style.display="block";this.DivAdminContainer.classList.add("selected")}else{this.DivAdminContentBox.style.display="none";this.DivAdminContainer.classList.remove("selected")}}}AttachCommonButtonsToMainToolbar(){const t=this.toolbar.GroupNameExist("common.1");if(!t){const e=this.toolbar.CreateButtonsAndMenus([],"Efferent.PlatformClient","common.1","workstation");const t=this.toolbar.IndexGroupPerName("main.1")||0;const i=this.toolbar.Groups[t];this.toolbar.Groups.splice(t+1,0,e);e.Create(this.toolbar.Element,i.Element.nextElementSibling)}const o=[["refresh",e.ClientViews.CommonView.ResourceBag.Icons8Refresh32Png,e=>{this.platform.CurrentView.Refresh()}]];this.toolbar.AppendControlsToGroup([o],"Efferent.PlatformClient","common.1","workstation");const r=this.RebuildTagsMenu(this.platform.CurrentView,null,true);this.toolbar.AppendControlsToGroup([r],"Efferent.PlatformClient","common.1","workstation");const l=this.toolbar.GetButton("Tags");if(l.Child!==undefined&&l.Child!==null){l.Child.CreateExtraContainer("tagMenuToolbar")}this.appendActionToCustomTagInput();const s=[["shareTool",a.ResourceBag.Icons8ForwardArrow32Png,e=>{let t=e.target;if(this.ShareController.SharedFlyout&&this.ShareController.SharedFlyout.style.display!=="none"){this.ShareController.SharedFlyout.style.display="none";this.toolbar.DeselectAllButtons()}else{if(!i.HasClass(t,"toolbarButton"))t=t.parentElement;const e=this.platform.CurrentView.GetFhirEntities();if(e!==null&&e!==undefined&&e.length>=1){this.ShareController.OpenShared(t)}else n.Toaster.ShowToast("Please select a record",n.Colors.BelizeHole,3)}},,,,,"toolbarDrop"]];this.toolbar.AppendControlsToGroup([s],"Efferent.PlatformClient","common.1","workstation")}RegisterCommonPane(){this.TagPane=new a.TagPane(this.platform.CurrentView,this.platform.ContentRowContainer);this.platform.ResizeListeners.push(new n.ResizeStructure(this.TagPane.constructor.name.toLowerCase(),this.TagPane,this.TagPane.constructor.name));this.ShareController=new a.ShareController(this.platform.CurrentView,this.platform.ContentRowContainer)}Logout(e){this.userSectionController.Logout(e)}ToggleEditToolbar(){var e;if(!this.MainToolbar)this.MainToolbar=this.toolbarSection.querySelector(".mainToolbar");const t=document.getElementById("sharedFlyout");if(t&&n.DOMUtils.IsDisplay(t))n.DOMUtils.RemoveItem(t);n.Toolbar.HideAllMenus();if(this.isOpenEditToolbar){this.DivEditToolbar.style.display="none";n.Toolbar.EditMode=false;this.customBarHandler.Deactivate();this.removeClonedToolbar(this.MainToolbar);const e=setTimeout((()=>{window.dispatchEvent(new Event("resize"));clearTimeout(e)}),200)}else{this.DivEditToolbar.style.display="flex";n.Toolbar.EditMode=true;this.customBarHandler.Activate();if((e=this.platform.CurrentView.FilterController)===null||e===void 0?void 0:e.IsPinned()){this.platform.CurrentView.FilterController.TogglePinSearchPane();this.platform.Toolbar.Topbar.Hide()}window.dispatchEvent(new Event("resize"));this.cloneToolbar(this.MainToolbar);this.customBarHandler.SetupDragEventsOnToolbar()}this.isOpenEditToolbar=!this.isOpenEditToolbar}SaveToolbarOrderPreference(e){const t=this.getSettingName();this.platform.SetSetting(l.SettingsController.SETTING_VALUES.USER,t,e)}GetToolbarOrderPreference(){const e=this.getSettingName();return this.platform.GetSetting(e)}LoadPreferences(){if(!this.MainToolbar)this.MainToolbar=document.querySelector(".mainToolbar");this.customBarHandler.LoadPreferences(this.MainToolbar)}getSettingName(){const e=o.GetUrlParameter("view");let t=e?`toolbarOrder${r.Capitalize(e)}`:"toolbarOrderStudyWorklist";if(e==="viewStudy")t=this.customBarHandler.GetStudyType()==="mp4"?"toolbarOrderViewStudyMp4":"toolbarOrderViewStudy";return t}cloneToolbar(e){this.ClonedToolbar=e.cloneNode(true);this.ClonedToolbar.classList.add("clonedToolbar");this.toolbarSection.appendChild(this.ClonedToolbar);this.toolbarSection.insertBefore(e,this.ClonedToolbar);this.ClonedToolbar.style.display="block";e.style.display="none";const t=this.toolbarSection.querySelectorAll(".mainToolbar");if(t.length>2){for(let e=0;e<t.length;e++){const i=t[e];if(!i.classList.contains("clonedToolbar")){this.toolbarSection.removeChild(i);return}}}}removeClonedToolbar(e){this.ClonedToolbar.style.display="none";this.ClonedToolbar.parentElement.removeChild(this.ClonedToolbar);this.ClonedToolbar=null;e.style.display="block"}appendActionToCustomTagInput(){const e=document.getElementById("inputCustomTag");i.ForceCharacter(e);e.addEventListener(r.INPUTKEY_EVENTS.KEYDOWN,(t=>{if(t.key===r.INPUTKEY_NAMES.ENTER){const t=e.value.replace(/[^0-9a-z]/gi,"").trim().toUpperCase();if(t!==""){const e=this.platform.CurrentView.GetFhirEntities();if(a.TagController.ExistTag(this.platform.CurrentView,t,e))return;if(e.length>0){a.TagController.AddTagToResource(this.platform.CurrentView,t,e,(e=>{this.platform.CurrentView.OnTagChanged(e)}),true)}else{n.Toaster.ShowToast("Please select a record.",n.Colors.BelizeHole,3)}n.Toolbar.HideAllMenus();this.platform.Toolbar.DeselectAllButtons()}else{n.Toaster.ShowToast("Please input a name for the new tag",n.Colors.BelizeHole,3)}}}))}buildButtons(){return s({className:"editToolbarSection",children:[s({className:"margin",children:[s({className:"actionButtonsContainer",children:[h({innerHTML:"Save",className:"green",onclick:()=>{this.customBarHandler.SavePreferences();this.ToggleEditToolbar()}}),h({innerHTML:"Cancel",className:"red",onclick:()=>{this.customBarHandler.LoadPreferences(this.MainToolbar);this.ToggleEditToolbar()}}),h({innerHTML:"Reset",className:"red",onclick:()=>{this.customBarHandler.ResetPreferences();this.ToggleEditToolbar();window.location.reload()}})]})]})]})}}t.HeaderController=HeaderController})(t=e.PlatformClient||(e.PlatformClient={}))})(Efferent||(Efferent={}));var Efferent;(function(Efferent){var PlatformClient;(function(PlatformClient){var Utils=Efferent.Frontend.WebClient.Utils;var DOMUtils=Efferent.Frontend.WebClient.DOMUtils;var HttpUtils=Efferent.Frontend.WebClient.HttpUtils;var WebClient=Efferent.Frontend.WebClient;var SettingsClient=Efferent.Frontend.SettingsClient;var FlatUI=Efferent.Frontend.FlatUI;var LayoutManager=Efferent.Frontend.WebClient.LayoutManager.LayoutManager;var LayoutType=Efferent.Frontend.WebClient.LayoutManager.LayoutType;var Panel=Efferent.Frontend.WebClient.LayoutManager.Panel;var DockPanelPosition=Efferent.Frontend.WebClient.LayoutManager.DockPanelPosition;class Main{constructor(e){this.globalEvents={};this.BrowsingHistory=[];this.ApplicationTags={};this.SortParameters={};this.SearchParameters={};this.UserProfileData={};try{this.ApplicationTags=JSON.parse(sessionStorage["applicationTags"]);const e=WebClient.HttpUtils.GetUrlParameter("tag");if(e==="Patient"){this.ApplicationTags["dummyPatient"]=true}}catch(e){this.ApplicationTags={user:true}}if(sessionStorage["BrowsingHistory"]!==undefined)this.BrowsingHistory=sessionStorage["BrowsingHistory"].split(",");this.headerController=new PlatformClient.HeaderController(this);this.CustomerCreationController=new PlatformClient.CustomerCreationController;this.UserCreationController=new PlatformClient.UserCreationController(this);this.isRegisteredActions=false;this.actionsListenerExistingView=new Array;this.DataBackForViewChange={};this.CacheTries=0;this.Username=sessionStorage["userEmail"];this.ShowSettings=false;this.ResizeForCacheOrMessageBar=false;this.TemporalSettingsTabs=new Array;this.resourceBag=FlatUI.ResourceBag;this.ListDNSUnBlockedForSLConnection=localStorage["ListDNSUnBlockedForSLConnection"]?JSON.parse(localStorage["ListDNSUnBlockedForSLConnection"]):{};WebClient.LocalStorage.Initialize(this.Username);if(sessionStorage["token"]===undefined||sessionStorage["token"]===null){const e=HttpUtils.GetUrlParameter("getExternal");const t=HttpUtils.GetUrlParameter("jwt");let i="";const o=sessionStorage["standAloneOnline"];if(e!==undefined&&e!==null&&e!==""||t!==undefined&&t!==null&&t!=="")i=location.href.split("?")[1];if(o)i+="&cachews=inactive";location.replace("login.html"+(i!==""?"?"+i:""));return}else{if(sessionStorage["debug"]!==undefined&&sessionStorage["debug"]==="active"){const e=HttpUtils.GetUrlParameter("debug");if(e===null||e===undefined||e!=="active"){location.replace(location.href+"&debug=active");return}}}this.OpenWindows=new Array;this.containerElement=document.getElementById(e);this.isActiveCacheMessage=false;this.isActiveStaticMessage=false;this.isActiveAutomaticModeConnectMessage=false;this.orientationChange=false;this.syncInterval=3e4;this.ResizeListeners=new Array;window["OnSuccessAjaxControl"]=HttpUtils.OnSuccessAjaxControl=(e,t)=>{this.OnSuccessAjaxControl(e,t)};window["OnErrorAjaxControl"]=HttpUtils.OnErrorAjaxControl=(e,t,i)=>{this.OnErrorAjaxControl(e,t,i)};window["OnErrorAjaxFhirControl"]=Efferent.Frontend.FhirClient.FhirCall.OnError=(e,t,i)=>{this.OnErrorAjaxControl(e,t,i)};SettingsClient.SettingsController.BaseUrl=WebClient.PlatformContext.PlatformUri;WebClient.Loader.Show();SettingsClient.SettingsController.GetSettings((e=>{WebClient.Loader.Hide();this.onGetSettings(e);WebClient.DateRangePicker.DateFormat=this.GetSetting("dateFormat")}))}OnSuccessAjaxControl(e,t){switch(t){case 202:const t=e.getResponseHeader("Location");const i=e.responseURL.indexOf("refreshUI")>-1?this.CurrentView:null;WebClient.LongRunningTaskDialog.Show(t,i);break}}OnErrorAjaxControl(e,t,i){var o;try{if(this.isActiveCacheMessage&&e.match("sync"))return;if(!this.CacheConnect.OfflineMode&&e.match("login"))return;const n=sessionStorage["standAloneOnline"];let a=new URL(e);switch(i){case 503:if(a.origin===location.origin){let e=(o=t.getResponseHeader("Retry-After"))!==null&&o!==void 0?o:30;WebClient.Toaster.ShowToast(`The platform is under maintenance. Please come back in ${e} minutes`,WebClient.Colors.SunFlower,5,WebClient.Colors.Pomegranate)}break;case 401:if(a.origin===location.origin){localStorage.removeItem("defaultUser");localStorage.removeItem("defaultPass");if(n==="active")location.replace("login.html?cachews=inactive");else location.replace("login.html")}break;case 403:break;case 440:if(a.origin===location.origin){if(n==="active")location.replace("login.html?cachews=inactive");else location.replace("login.html")}break;case 412:let e=t.getResponseHeader("X-Error");WebClient.Toaster.ShowToast(e,WebClient.Colors.Alizarin,5);break;case 0:try{if(a.origin===location.origin){WebClient.Toaster.ShowToast("Failed connection to platform",WebClient.Colors.BelizeHole,5.5)}else{WebClient.Toaster.ShowToast("Failed connection to service "+a.origin,WebClient.Colors.BelizeHole,5.5)}}catch(e){WebClient.Utils.DebugConsoleLog(e)}break}}catch(e){WebClient.Utils.DebugConsoleLog("Error Ajax control => "+e)}}InjectPlugins(e,t){const i=e.Plugins;const o=[];this.PluginsArray=[];let n=[];const a=SettingsClient.SettingsController.GetSetting("Plugins");if(a!==null&&a!==undefined){try{const t=JSON.parse(WebClient.Utils.DecodeBase64(a.value));n=t[e["Type"]]}catch(e){}}if(i!==undefined&&i.length>0){for(let e=0;e<i.length;e++){const t=i[e];const n="Vue.Products."+t+"."+t;this.PluginsArray.push(n);o.push(t)}const e=[];const n=Efferent.Frontend.WebClient.Utils.IsDebugActive()==="active"?"":".min";for(let t=0;t<o.length;t++){e.push("out/"+o[t]+n+".js")}if(e.length>=1){Efferent.Frontend.WebClient.DOMUtils.LoadJsToHead(e,[t,this.executeActionsWhenViewExists.bind(this)])}else{WebClient.Toaster.ShowToast("Error loading the application plugins.",WebClient.Colors.BelizeHole,3);window.setTimeout((()=>{if(this.GetRolName()!=="GUEST"){this.SwitchView(this.BrowsingHistory[this.BrowsingHistory.length-1],"back")}}),3.5)}}else{t();this.executeActionsWhenViewExists()}}SwitchView(e,t,i){document.title="Efferent Platform";if(this.CurrentView){this.DataBackForViewChange[this.CurrentView.SpecView.Id]=this.CurrentView;this.CurrentView.Dispose()}const getDevQuery=()=>{const e=HttpUtils.GetUrlParameter("debug");const t=HttpUtils.GetUrlParameter("sync");const i=HttpUtils.GetUrlParameter("socket");let o="";if(e!=="")o+=`&debug=${e}`;if(t!=="")o+=`&sync=${t}`;if(i!=="")o+=`&socket=${i}`;return o};if(e!==undefined){switch(t){case undefined:e+=getDevQuery();if(window.location.search!==e){this.BrowsingHistory.push(window.location.search)}break;case"back":this.BrowsingHistory.splice(this.BrowsingHistory.length-1,1);break;case"home":e=`?&home${getDevQuery()||""}`;this.BrowsingHistory=[];break}sessionStorage["BrowsingHistory"]=this.BrowsingHistory.toString();if(e==="")e="?&home";history.replaceState("","",e);this.headerController.TogglePrimaryNavigationButtons()}this.containerElement.innerHTML="";WebClient.Loader.Show();this.CurrentSpec=new WebClient.SpecReader(JSON.parse(sessionStorage["currentSpec"]),sessionStorage["role"],this.ApplicationTags);if(this.CurrentSpec===undefined){WebClient.Toaster.ShowToast("Error loading the application specification.",WebClient.Colors.BelizeHole,3);return}this.LanguageManager.AddDictionary("","SpecDictionary",this.CurrentSpec.Dictionaries[this.LanguageManager.CurrentLanguage]);this.LanguageManager.AddDictionary("{Efferent.PlatformClient.ResourceBag.PlatformLanguageJson}","Efferent.PlatformClient",Efferent.PlatformClient.ResourceBag.PlatformLanguageJson[this.LanguageManager.CurrentLanguage]);WebClient.Loader.Hide();this.Configuration=new PlatformClient.Configuration(this);this.Configuration.GetConfigurationParams();this.LoadMainPage();this.activateView(i);const o=[["Toolbar",PlatformClient.ResourceBag.IconEditPng,e=>{this.headerController.ToggleEditToolbar()}]];const n=[["settings",PlatformClient.ResourceBag.Icons8Settings32Png,e=>{this.SettingsSubView=this.ActivateSubView("SettingsView",{});this.LoadSettingsFromPlugins();this.SetTemporalTabsOnSubView();this.SettingsSubView.Pane.ShowSection()}]];const a=[["feedbackTool",PlatformClient.ResourceBag.Icons8Advertising32Png,e=>{window.open("https://efferenthealth.com/support/","_blank")}]];const r=[["profile",WebClient.ResourceBag.Icons8AdminSettingsMale32Png,e=>{const t=new PlatformClient.ProfilePane(this.GetMainContainer(),this)}]];const l=[["logout",WebClient.ResourceBag.Icons8Shutdown32Png,e=>{this.Logout()}]];const s=[["offline",Efferent.PlatformClient.ResourceBag.UnavailableCloud32Png,e=>{this.Toolbar.DeselectAllButtons();if(sessionStorage["RepositoryOnlineBaseUri"]!==undefined)this.CacheConnect.DeactivateCache(false);else this.CacheConnect.ActivateCache(true)}]];const d=this.CurrentSpec.Functions[0]["Views"];const c=d[this.CurrentView["SpecView"].Id];let h;if(sessionStorage["standAloneOnline"]==="active")h=[n,a];else h=[o,n,a,s];if(sessionStorage["isSuperAdmin"]===undefined){h.push(r)}h.push(l);this.headerController.UserToolbar.AppendControlsToLastGroup(h,"Efferent.PlatformClient","main");const u=this.headerController.UserToolbar.GetElementsByGroupName("userSectionNav");this.headerController.SetMainToolbar();u.forEach((e=>{const t=e.Element;DOMUtils.AddClass(t,"toolbarItemUserMenu")}));document.documentElement.addEventListener("webkitfullscreenchange",this.CurrentView.OnFullScreenChange.bind(this));document.documentElement.addEventListener("mozfullscreenchange",this.CurrentView.OnFullScreenChange.bind(this));document.documentElement.addEventListener("fullscreenchange",this.CurrentView.OnFullScreenChange.bind(this));setTimeout((()=>{this.headerController.ManageButtonAdmin();this.headerController.LoadPreferences()}),500);delete this.DataBackForViewChange[this.CurrentView.SpecView.Id];if(!this.firstLoad&&sessionStorage["isSuperAdmin"]===undefined&&!this.ApplicationTags.hasOwnProperty("patient")&&sessionStorage["practitionerId"]!=="dummy"){let e;let t;try{e=this.UserProfileData["name"][0].family;t=this.UserProfileData["name"][0].given[0]}catch(i){e="";t=""}if(t===""||e===""){const e=new PlatformClient.ProfilePane(this.GetMainContainer(),this);WebClient.Toaster.ShowToast("Please complete your profile.",WebClient.Colors.Orange,4)}this.firstLoad=true}}LoadSettingsFromPlugins(){if(this.CurrentView.Plugins&&this.CurrentView.Plugins.length>0){this.CurrentView.Plugins.forEach((e=>{const t=e.GetSettingsPaneNames();if(t.length>0){t.forEach((t=>{e.CreateSettingsPane(t,null)}))}}))}}GetRolName(){let e;try{const t=new Efferent.Frontend.WebClient.JwtParser(sessionStorage["token"]);const i=t["Payload"]["app_tags"].split(",");e=i[0]}catch(t){e=null}finally{if(!e)e=null}return e}RegisterGlobalEvents(e,t,i,o){if(!this.globalEvents[e]){document.documentElement.addEventListener(t,o,false);this.globalEvents[e]=i}else{this.globalEvents[e]=i}}RemoveGlobalEvents(e){for(const t in this.globalEvents){if(Object.prototype.hasOwnProperty.call(this.globalEvents,t)){const i=this.globalEvents[t];if(i.view===e){document.documentElement.removeEventListener(i.name,i.event,false);delete this.globalEvents[t]}}}}GetGlobalEvent(e){let t;if(this.globalEvents[e])t=this.globalEvents[e];return t}RebuildToolbar(){this.headerController.ManageButtonAdmin()}Logout(e){this.headerController.Logout(e)}ToolbarSectionHeight(){return this.headerController.HeaderSection.clientHeight}HeaderSectionHeight(){return this.headerController.HeaderSection.clientHeight}RebuildTagsMenu(e,t,i=false){return this.headerController.RebuildTagsMenu(e,t,i)}SearchState(e,t){var i;let o;if(t){this.SearchStateBar.innerHTML="";const e=DOMUtils.img({src:PlatformClient.ResourceBag.Icons8Search32Png});const i=DOMUtils.div({innerText:t});const n=DOMUtils.button({innerText:"Clear filter",className:"red",onclick:()=>{sessionStorage.removeItem("appliedFilter");sessionStorage.removeItem("searchParamString");sessionStorage.removeItem("searchParamStatus");localStorage.removeItem("QuickSearchHolding");let e=decodeURIComponent(WebClient.HttpUtils.GetUrlParameter("view"));if(e===""){e=this.CurrentView["SpecView"].Id}window.history.replaceState("page2","Title","main.html?"+"view="+e+"&URN="+encodeURIComponent(this.CurrentView["SpecView"].URN));this.CurrentView.LoadData();this.CurrentView.ShowPanes(true);this.CurrentView.Platform.SearchState(false);if(!this.CurrentView.FilterController.IsPinned())this.CurrentView.Platform.Toolbar.Topbar.Hide()}});o=DOMUtils.button({innerText:"Edit filter",className:"green",onclick:()=>{var e;let t=((e=this.GetRolName())===null||e===void 0?void 0:e.match(/ADMIN/))||false;let i=this.CurrentView.FilterController.GetFilterPane().IsFilterOrganization();if(!t&&i){WebClient.Toaster.ShowToast("You do not have permission to edit the general filter.",WebClient.Colors.Orange,3)}else{this.CurrentView.FilterController.OpenFilter(sessionStorage.getItem("appliedFilter"))}}});o.style.marginRight="10px";this.SearchStateBar.appendChild(e);this.SearchStateBar.appendChild(i);this.SearchStateBar.appendChild(o);this.SearchStateBar.appendChild(n);if(sessionStorage["appliedFilter"]!=="QuickSearchObject"){let e="Set as default";let t="Clear default";let i=this.CurrentView.ViewName;let o=this.CurrentView.SpecView.Id;let n=`defaultPreferred${o}`;let a=SettingsClient.SettingsController.GetSetting(n,undefined,i,o);let r=a&&a.value!=="null"&&a.value!==null&&a.value===sessionStorage["appliedFilter"];const l=DOMUtils.button({innerText:r?t:e,className:r?"orange":"green",style:{marginLeft:"10px",width:"130px"},onclick:()=>{let s=Efferent.Frontend.SettingsClient.SettingsController.SETTING_VALUES.VIEW_INSTANCE;i=this.CurrentView.ViewName;o=this.CurrentView.SpecView.Id;n=`defaultPreferred${o}`;a=SettingsClient.SettingsController.GetSetting(n,undefined,i,o);r=a&&a.value!==""&&a.value===sessionStorage["appliedFilter"];if(r){SettingsClient.SettingsController.SetSetting(s,n,null,(()=>{WebClient.Toaster.ShowToast("Default filter removed.",WebClient.Colors.Alizarin,3)}),false,undefined,false,i,o);l.innerText=e;l.className="green"}else{SettingsClient.SettingsController.SetSetting(s,n,sessionStorage["appliedFilter"],(()=>{WebClient.Toaster.ShowToast("Default filter saved.",WebClient.Colors.Emerald,3)}),false,undefined,false,i,o);l.innerText=t;l.className="orange"}}});this.SearchStateBar.appendChild(l)}}const n=WebClient.LocalStorage.Get("isPinned")==="true";if(this.SearchStateBar){if(e){this.SearchStateBar.style.display="flex";const e=(i=this.CurrentView["SpecView"])===null||i===void 0?void 0:i.hasOwnProperty("SearchParameters");o.style.display=e?"block":"none"}else{this.SearchStateBar.style.display="none"}}}ShowMessageCacheMode(){if(sessionStorage["RepositoryOnlineBaseUri"]!==undefined){this.isActiveCacheMessage=true;this.MessageBar.style.display="block";this.MessageBar.innerHTML="Working in offline mode. The worklist shown is stored locally and differs from the cloud worklist";this.MessageBar.style.backgroundColor=WebClient.Colors.Carrot}else{this.MessageBar.style.display="none";this.isActiveCacheMessage=false}}ToogleMessageAutomaticConnectToSL(e){if(e){let e=document.createElement("button");e.className="green";e.innerHTML="Connect";e.style.display="inline-block";e.style.marginLeft="5px";e.onclick=e=>{PlatformClient.PlatformSettingsController.ConnectToSmartLink(this.CacheConnect.ServiceUrlCache,this,(e=>{if(e){this.ListDNSUnBlockedForSLConnection[this.CacheConnect.ServiceUrlCache]=this.CacheConnect.ServiceIpCache;localStorage["ListDNSUnBlockedForSLConnection"]=JSON.stringify(this.ListDNSUnBlockedForSLConnection);this.ToogleMessageAutomaticConnectToSL(false)}}))};this.isActiveAutomaticModeConnectMessage=true;let t=document.createElement("label");t.innerHTML="DNS detected for automatic mode to Smartlink";this.MessageBarAutoConnectSL.innerHTML="";this.MessageBarAutoConnectSL.appendChild(t);this.MessageBarAutoConnectSL.appendChild(e);this.MessageBarAutoConnectSL.style.display="block"}else{this.isActiveAutomaticModeConnectMessage=false;this.MessageBarAutoConnectSL.style.display="none"}this.CurrentView.UpdateUI()}ShowSwitchMessageToCacheMode(e){let t;let i;if(this.CacheTries===3&&!this.CacheConnect.OfflineMode){this.isActiveStaticMessage=true;this.MessageBar.style.display="block";this.MessageBar.innerHTML="The cloud or the cache server could not be accessed.";this.MessageBar.style.backgroundColor=WebClient.Colors.Alizarin;try{this.CurrentView.UpdateUI()}catch(e){Utils.DebugConsoleLog(e)}}else if(this.CacheConnect.OfflineMode){i=document.createElement("a");i.innerHTML="Click here";if(!e){t="Currently there is an internet connection. Do you want to reconnect to the cloud? ";i.href="#";i.onclick=()=>{this.CacheConnect.DeactivateCache()}}this.isActiveStaticMessage=true;this.MessageBar.style.display="block";this.MessageBar.innerHTML=t;this.MessageBar.appendChild(i);this.MessageBar.style.backgroundColor=e?WebClient.Colors.Carrot:WebClient.Colors.Nephritis;try{if(!this.ResizeForCacheOrMessageBar){this.CurrentView.UpdateUI();this.ResizeForCacheOrMessageBar=true}}catch(e){Utils.DebugConsoleLog(e)}}else if(!this.CacheConnect.OfflineMode){i=document.createElement("a");i.innerHTML="Click here";if(e){if(this.MessageBar.style.display==="none")this.ResizeForCacheOrMessageBar=false;t="There is no access to the cloud. Switch to local mode? ";i.href="#";i.onclick=()=>{this.CacheConnect.ActivateCache()};this.isActiveStaticMessage=true;this.MessageBar.style.display="block";this.MessageBar.innerHTML=t;this.MessageBar.appendChild(i);this.MessageBar.style.backgroundColor=e?WebClient.Colors.Carrot:WebClient.Colors.Nephritis}else{this.isActiveStaticMessage=false;if(this.MessageBar.style.display==="block")this.ResizeForCacheOrMessageBar=false;this.MessageBar.style.display="none"}try{if(!this.ResizeForCacheOrMessageBar){this.CurrentView.UpdateUI();this.ResizeForCacheOrMessageBar=true}}catch(e){Utils.DebugConsoleLog(e)}}}LoadMainPage(){this.TemporalSettingsTabs=new Array;this.Toolbar=this.headerController.CreateMainToolbar();const e=new LayoutManager(this.containerElement);e.SetLayout(LayoutType.DOCK,{style:{gap:"6px"}});const t=new Panel({domElement:this.headerController.HeaderSection,style:{flexDirection:"column",gap:"4px"}});const i=new Panel({className:"PaneWorkData",width:"100%",height:"100%"});const o=new Panel({className:"bodySection column"},[i]);e.Add(t,DockPanelPosition.TOP);e.AddLast(o);this.layoutManager=e;this.BodySection=o.GetDOMElement();this.ContentRowContainer=i.GetDOMElement();const n=new WebClient.Tab("platform",this.LanguageManager.GetValuesFromDict("Efferent.PlatformClient","platform").toUpperCase());n.ActionTab=e=>{const t=new PlatformClient.PlatformSettingsController(this);t.CreateSettings(e)};this.TemporalSettingsTabs.push(n);if(this.ApplicationTags.hasOwnProperty("superadmin")){const e=new WebClient.Tab("createOrg",this.LanguageManager.GetValuesFromDict("Efferent.PlatformClient","createOrg").toUpperCase());e.ActionTab=e=>{const t=document.createElement("div");t.className="wrapContent";e.appendChild(t);this.CustomerCreationController.CreateCustomerSection(t)};this.TemporalSettingsTabs.push(e);const t=new WebClient.Tab("createDevice",this.LanguageManager.GetValuesFromDict("Efferent.PlatformClient","createDevice").toUpperCase());t.ActionTab=e=>{const t=document.createElement("div");t.className="wrapContent";e.appendChild(t);this.CustomerCreationController.CreateDeviceSection(t)};this.TemporalSettingsTabs.push(t)}if(this.ApplicationTags.hasOwnProperty("admin")){const e=new WebClient.Tab("practitioners",this.LanguageManager.GetValuesFromDict("Efferent.PlatformClient","practitioners").toUpperCase());e.ActionTab=e=>{this.UserCreationController.CreateUserSection(e)};this.TemporalSettingsTabs.push(e)}}SetTemporalTabsOnSubView(){this.TemporalSettingsTabs.forEach((e=>{this.SettingsSubView.Pane.Tabs.push(e)}))}GetSetting(e,t){let i=SettingsClient.SettingsController.GetSetting(e,t);i=i&&typeof i==="object"?i.value:i;return i}SetSetting(e,t,i,o,n=false,a,r,l,s){SettingsClient.SettingsController.SetSetting(e,t,i,o,n,a,r,l,s)}GetLocalDeviceSmartLink(e){var t;const i=WebClient.PlatformContext.PlatformUri+"/platform/smartlink";sessionStorage["technology"]=(t=this.GetSetting("technology"))!==null&&t!==void 0?t:"Efferent";if(sessionStorage[""]===undefined||sessionStorage["technology"]===""||sessionStorage["technology"]==="Efferent"){WebClient.HttpUtils.AjaxCall(i,"GET",{},null,((t,i)=>{e(i)}),((t,i)=>{e(null)}))}}SwitchTheme(e){const t=e["LocalTheme"]?e["LocalTheme"]:this.GetSetting("theme").toLowerCase();const i=e["ViewName"]?e["ResourceBag"][e["ViewName"]+"Css"]:"";if(this.CurrentTheme)this.CurrentTheme.innerHTML=i;else this.CurrentTheme=DOMUtils.InjectCSS(i);document.documentElement.classList.remove("theme-light");document.documentElement.classList.remove("theme-dark");const o=document.documentElement.querySelector("meta[name=theme-color]");if(t==="dark"){document.documentElement.classList.add("theme-dark");o.setAttribute("content",WebClient.Colors.BgDarker)}else{document.documentElement.classList.add("theme-light");o.setAttribute("content",WebClient.Colors.Clouds)}}GetActiveMessageHeight(){let e=0;if(this.isActiveAutomaticModeConnectMessage){e=this.MessageBarAutoConnectSL.clientHeight}return this.isActiveCacheMessage||this.isActiveStaticMessage?this.MessageBar.clientHeight+e:e}ActivateSubView(viewType,parameters,optionalParameters){try{const fullClassName="Efferent.ClientViews."+viewType+"."+viewType;const subView=eval("new "+fullClassName+"(this.containerElement, this, parameters, optionalParameters)");return subView}catch(e){WebClient.Toaster.ShowToast("Error loading the view",WebClient.Colors.BelizeHole,3);return null}}GetMainContainer(){return this.containerElement}ShowTaskRunning(e,t=false){const i=WebClient.HttpUtils.GetUrlParameter("showTask")||e;if(i){const e=decodeURIComponent(i);const o=WebClient.HttpUtils.GetUrlParameter("refreshUI")||t?this.CurrentView:null;WebClient.LongRunningTaskDialog.Show(e,o)}}onGetSettings(e){if(e.error){Utils.DebugConsoleLog("The settings parameters could not be loaded => Server error response")}let t;if(sessionStorage["RepositoryOnlineBaseUri"]!==undefined||sessionStorage["OfflineForced"]!==undefined&&WebClient.Utils.StrToBool(sessionStorage["OfflineForced"])===true)t=true;else t=false;this.CacheConnect=new PlatformClient.CacheConnection(this,t);this.onCacheConnection();if(!t)this.CacheConnect.SearchDns()}onCacheConnection(){var e;if(this.CacheConnect.OfflineMode)this.ViewerMode=WebClient.EViewerMode.Offline;else this.ViewerMode=WebClient.EViewerMode.Cloud;if(sessionStorage["role"]!=="")WebClient.LocalStorage.Set("lastRoleId",sessionStorage["role"].split(",")[0]);else WebClient.LocalStorage.Set("lastRoleId","User");if(this.GetSetting("lang")===undefined)this.SetSetting(40,"lang","en");if(this.GetSetting("theme")===undefined)this.SetSetting(40,"theme","Dark");this.LanguageManager=new WebClient.LanguageManager(WebClient.PlatformContext.PlatformUri);this.LanguageManager.CurrentLanguage=this.GetSetting("lang")||WebClient.PlatformContext.Language;window.addEventListener("orientationchange",(e=>{this.orientationChange=true}));window.addEventListener("resize",(e=>{const t=document.documentElement.clientWidth;const i=document.documentElement.clientHeight;const o=e.target.document.activeElement;WebClient.Loader.OnResize();if(this.orientationChange||o.type!=="text"&&o.type!=="password"&&o.type!=="textarea"){for(const e in this.ResizeListeners){if(this.ResizeListeners.hasOwnProperty(e)){if(this.ResizeListeners[e]!==undefined){try{this.ResizeListeners[e].ClassInstance["isResize"]=true;this.ResizeListeners[e].ClassInstance.OnWindowResize(t,i);delete this.ResizeListeners[e].ClassInstance["isResize"]}catch(e){Utils.DebugConsoleLog(e)}}}}this.orientationChange=false}const n=window.innerWidth>window.innerHeight?90:0;if(n===90){const e=[];[].push.apply(e,document.getElementsByClassName("toolbarMenu"));e.forEach((e=>{const t=e.getElementsByClassName("toolbarMenuGroup").length+1}))}this.headerController.ManageButtonAdmin()}));if(sessionStorage["isSuperAdmin"]===undefined&&!this.ApplicationTags.hasOwnProperty("patient")&&sessionStorage["practitionerId"]!=="dummy"){const e=WebClient.PlatformContext.PlatformUri+"/fhir/"+sessionStorage["practitionerId"];const t=new Efferent.Frontend.FhirClient.FhirCall(e,"GET");t.FuncOk=e=>{if(e!==""){this.UserProfileData=JSON.parse(e);this.SwitchView()}};t.FuncError=e=>{this.SwitchView()};t.Send()}else{this.SwitchView()}const t=new Hammer(document.documentElement);t.on("tap",(e=>{const t=e.target.parentElement;const i=e.target;if(t!==null&&(DOMUtils.HasClass(t,"toolbarDrop")||DOMUtils.HasClass(t,"favoriteItems")||DOMUtils.HasClass(i,"ShareNameListElement")||DOMUtils.HasClass(i,"toolbarDrop")||DOMUtils.HasClass(i,"shareRadioButtons")||DOMUtils.HasClass(t,"toolbarMenuGroup")||DOMUtils.HasClass(t,"sharedSection")||DOMUtils.HasClass(t,"dropdown")||DOMUtils.HasClass(t,"toolbarMenuItem")||DOMUtils.HasClass(i,"toolbarMenuItem")||DOMUtils.HasClass(t,"buttonbar")||DOMUtils.HasClass(t,"toolbarItemUserMenu")||DOMUtils.HasClass(i,"toolbarItemUserMenu"))){return}if(document.getElementsByClassName("contextMenuContainer")[0]!==undefined)DOMUtils.HideElement(document.getElementsByClassName("contextMenuContainer")[0]);if(i.getAttribute("id")!=="AdminButton"&&(t&&t.getAttribute("id")!=="AdminButton"))this.headerController.ToggleAdminViewContainer(true);const o=document.getElementById("sharedFlyout");if(o&&WebClient.DOMUtils.IsDisplay(o)&&!WebClient.DOMUtils.HasClassInAnyParents(i,"sharedSection"))WebClient.DOMUtils.RemoveItem(o);WebClient.Toolbar.HideAllMenus();const n=document.getElementsByClassName("toolbarDrop");if(n!==null){for(let e=0;e<n.length;e++){const t=n[e];if(!DOMUtils.HasClass(t,"optionInMenuPressed"))DOMUtils.RemoveClass(t,"selected")}}}));window.onpopstate=e=>{e.preventDefault();this.CurrentView.OnPopState(e)};window.addEventListener("beforeunload",(e=>{}));window.onunload=e=>{if(sessionStorage["pageView"]!=="viewerNewWindow"){this.CurrentView.OnUnload(e)}};sessionStorage["technology"]=(e=this.GetSetting("technology"))!==null&&e!==void 0?e:"Efferent";if(sessionStorage["technology"]===undefined||sessionStorage["technology"]===""||sessionStorage["technology"]==="Efferent"){if(this.isActiveCacheMessage){this.CacheConnect.ActivateIntervalCacheController()}else{const e=WebClient.HttpUtils.GetUrlParameter("sync");if(e===undefined||e===""||e!=="inactive"){const e=setInterval((()=>{try{const e=WebClient.PlatformContext.PlatformUri+"/platform/sync";HttpUtils.AjaxCall(e,"GET",null,null,(()=>{this.ShowSwitchMessageToCacheMode(false);if(this.CacheTries>=3)this.CacheTries=0}),(e=>{if(e===0){if(!this.isActiveCacheMessage){if(!this.CacheConnect.IsActivatingCache)this.ShowSwitchMessageToCacheMode(true)}}else{this.ShowSwitchMessageToCacheMode(false);if(this.CacheTries>=3){this.CacheTries=0}}}))}catch(t){clearInterval(e)}}),this.syncInterval)}}}}activateView(optionalParameters){const currentView=HttpUtils.GetUrlParameter("view")||this.CurrentSpec.GetDefaultView().Id;const parameters={};const locationData=location.href.split("?");if(locationData.length>1){const e=locationData[1].split("&");for(let t=0;t<e.length;t++){const i=e[t].split("=");parameters[i[0]]=i[1]}}const viewId=currentView;const view=this.CurrentSpec.Functions[0].Views[viewId];const viewType=view["Type"];const fullClassName="Efferent.ClientViews."+viewType+"."+viewType;this.CurrentView=eval("new "+fullClassName+"(this.ContentRowContainer, this, view, parameters, optionalParameters)");clearInterval(this.autoRefreshInterval);if(view.hasOwnProperty("AutoRefresh")){const e=view["AutoRefresh"]<15?15e3:view["AutoRefresh"]*1e3;this.autoRefreshInterval=setInterval((()=>{this.CurrentView.Refresh()}),e)}this.SearchStateBar=document.createElement("div");DOMUtils.AddClass(this.SearchStateBar,"SearchStateBar");this.BodySection.insertBefore(this.SearchStateBar,this.BodySection.firstChild);this.MessageBar=document.createElement("div");DOMUtils.AddClass(this.MessageBar,"CacheLabel");this.BodySection.insertBefore(this.MessageBar,this.BodySection.firstChild);this.MessageBarAutoConnectSL=document.createElement("div");DOMUtils.AddClass(this.MessageBarAutoConnectSL,"AutoConnectSLLabel");this.BodySection.insertBefore(this.MessageBarAutoConnectSL,this.BodySection.firstChild);this.ShowMessageCacheMode();if(this.isActiveCacheMessage){this.CacheConnect.ActivateIntervalCacheController()}this.ShowTaskRunning()}executeActionsWhenViewExists(){try{if(!this.isRegisteredActions){this.actionsListenerExistingView.push(this.headerController.AttachCommonButtonsToMainToolbar.bind(this.headerController));this.actionsListenerExistingView.push(this.headerController.RegisterCommonPane.bind(this.headerController));this.isRegisteredActions=true;let e;this.CurrentView!==undefined&&this.CurrentView!==null?e=0:e=500;this.intervalIdActionsListener=setInterval((()=>{this.executeActionsWhenViewExists()}),e)}else{if(this.CurrentView!==undefined&&this.CurrentView!==null){this.actionsListenerExistingView.forEach(((e,t)=>{if(e!==undefined){e();delete this.actionsListenerExistingView[t]}}));clearInterval(this.intervalIdActionsListener);this.isRegisteredActions=false;this.intervalIdActionsListener=undefined}}}catch(e){if(this.intervalIdActionsListener!==null&&this.intervalIdActionsListener!==undefined){clearInterval(this.intervalIdActionsListener)}}}}PlatformClient.Main=Main})(PlatformClient=Efferent.PlatformClient||(Efferent.PlatformClient={}))})(Efferent||(Efferent={}));var Efferent;(function(e){var t;(function(t){var i=e.Frontend.WebClient;let o;(function(e){e[e["None"]=0]="None";e[e["Manual"]=1]="Manual";e[e["Automatic"]=2]="Automatic"})(o=t.EModesConnectionSL||(t.EModesConnectionSL={}));class PlatformSettingsController{constructor(e){this.platform=e}CreateSettings(n){var setSystemSettings=e=>{var a=["--Select--"];var r=["0"];var l=[];if(e!==null){var s=JSON.parse(e);try{var d=s["entry"];for(var c=0;c<d.length;c++){if(d[c]["resource"]["url"]!==undefined){a.push(d[c]["resource"]["url"]);r.push(d[c]["resource"]["url"])}if(d[c]["resource"]["ip"]!==undefined){l.push(d[c]["resource"]["ip"])}}}catch(e){a=["--Select--"];r=["0"]}}var h=this.platform.SettingsSubView.Pane;h.DataA["optionsLocalCache"]=a;h.DataA["valuesLocalCache"]=r;h.DataA["dataOptionsLocalCache"]=l;h.DataA["actionUrlLocalXC"]=(e,t)=>{var o=t.GetField("chkActiveLocalRepo");var n=t.GetField("chkSmartLinkConnectionNone");var a=i.Form.GetFieldFromForms(h.DataA,"urlLocalXC");if(i.Utils.IsURL(e.target.value)){sessionStorage.removeItem("serviceIpCache");this.platform.CacheConnect.ServiceUrlCache=e.target.value;var r=e.target.getAttribute("data-aditional");this.platform.SetSetting(40,"ipLocalRepo",r);this.platform.SetSetting(40,"urlLocalRepo",e.target.value)}else{i.Toaster.ShowToast("DNS invalid",i.Colors.BelizeHole,3);e.target.value=0;sessionStorage.removeItem("serviceIpCache");this.platform.CacheConnect.ServiceUrlCache="";o.htmlElement.checked=false;n.htmlElement.checked=true;this.platform.SetSetting(40,"localRepoActive","false");this.platform.SetSetting(40,"urlLocalRepo","");this.platform.SetSetting(40,"ipLocalRepo","");a.htmlElement.selectedIndex=0;a.htmlElement.disabled=true}};h.DataA["valueLocalCache"]=this.platform.GetSetting("urlLocalRepo")!=="undefined"&&this.platform.GetSetting("urlLocalRepo")!==undefined?this.platform.GetSetting("urlLocalRepo"):i.Utils.StrToBool(this.platform.GetSetting("urlLocalRepo"))||0;h.DataA["localRepoActive"]=this.platform.GetSetting("localRepoActive")||false;h.DataA["lang"]=this.platform.GetSetting("lang");h.DataA["actionSelectLanguage"]=e=>{this.platform.SetSetting(40,"lang",e.target.value,(()=>{location.reload()}))};h.DataA["theme"]=this.platform.GetSetting("theme");h.DataA["dateFormat"]=this.platform.GetSetting("dateFormat");h.DataA["onDoubleClick"]=this.platform.GetSetting("onDoubleClick");let u=i.Utils.CheckNotAllowTag(["patient","guest"]);h.DataA["showOrHideClass"]=u?[""]:["forceDisplayNone"];h.DataA["showOrHideNewLine"]=u;var m=this.platform.GetSetting("automaticSelection");h.DataA["disabledLocalCache"]=PlatformSettingsController.GetModeConnectSmartLink(this.platform)!==o.Manual;h.DataA["chkAutomaticSelection"]=m!==undefined&&m!==null?i.Utils.StrToBool(m):false;h.DataA["actionCheckAutomaticSelection"]=(e,t,i)=>{var o=e.target;var n=i.GetField("urlLocalXC");if(o.checked){n.htmlElement.disabled=true;this.platform.SetSetting(40,"automaticSelection","true");this.platform.CacheConnect.ConnectToAutomaticDns();this.platform.CacheConnect.SearchDns()}else{n.htmlElement.disabled=false;this.platform.SetSetting(40,"automaticSelection","false");this.platform.CacheConnect.ServiceUrlCache=this.platform.GetSetting("urlLocalRepo");this.platform.CacheConnect.ServiceIpCache=this.platform.GetSetting("ipLocalRepo");try{clearInterval(this.platform.CacheConnect.GetIntervalDnsSearching())}catch(e){}}};h.DataA["actionCheckLocalRepo"]=(e,t)=>{var o=e.target;if(o.checked){this.platform.SetSetting(40,"localRepoActive","true");var n=i.Form.GetFieldFromForms(h.DataA,"urlLocalXC");n.htmlElement.focus()}else{this.platform.SetSetting(40,"localRepoActive","false");this.platform.SetSetting(40,"urlLocalRepo","")}};let p=PlatformSettingsController.GetModeConnectSmartLink(this.platform);switch(p){case o.None:h.DataA["checkedSmartLinkConnectionNone"]=true;h.DataA["checkedSmartLinkConnectionManual"]=false;h.DataA["checkedSmartLinkConnectionAutomatic"]=false;break;case o.Manual:h.DataA["checkedSmartLinkConnectionNone"]=false;h.DataA["checkedSmartLinkConnectionManual"]=true;h.DataA["checkedSmartLinkConnectionAutomatic"]=false;break;case o.Automatic:h.DataA["checkedSmartLinkConnectionNone"]=false;h.DataA["checkedSmartLinkConnectionManual"]=false;h.DataA["checkedSmartLinkConnectionAutomatic"]=true;break}h.DataA["ActionChkSmartLinkConnectionNone"]=()=>{this.platform.SetSetting(40,"localRepoActive","false");this.platform.SetSetting(40,"urlLocalRepo","");this.platform.SetSetting(40,"automaticSelection","false");this.platform.CacheConnect.ServiceUrlCache=this.platform.GetSetting("urlLocalRepo");this.platform.CacheConnect.ServiceIpCache=this.platform.GetSetting("ipLocalRepo");try{clearInterval(this.platform.CacheConnect.GetIntervalDnsSearching())}catch(e){}var e=i.Form.GetFieldFromForms(h.DataA,"urlLocalXC");e.htmlElement.selectedIndex=0;e.htmlElement.disabled=true};h.DataA["ActionChkSmartLinkConnectionManual"]=()=>{this.platform.SetSetting(40,"localRepoActive","true");this.platform.SetSetting(40,"automaticSelection","false");this.platform.CacheConnect.ServiceUrlCache=this.platform.GetSetting("urlLocalRepo");this.platform.CacheConnect.ServiceIpCache=this.platform.GetSetting("ipLocalRepo");try{clearInterval(this.platform.CacheConnect.GetIntervalDnsSearching())}catch(e){}var e=i.Form.GetFieldFromForms(h.DataA,"urlLocalXC");e.htmlElement.disabled=false;e.htmlElement.focus()};h.DataA["ActionChkSmartLinkConnectionAutomatic"]=()=>{var e=i.Form.GetFieldFromForms(h.DataA,"urlLocalXC");e.htmlElement.selectedIndex=0;e.htmlElement.disabled=true;this.platform.SetSetting(40,"automaticSelection","true");this.platform.SetSetting(40,"urlLocalRepo","");this.platform.CacheConnect.ConnectToAutomaticDns();this.platform.CacheConnect.SearchDns()};h.DataA["disabledHighResSelection"]=this.platform.ApplicationTags.hasOwnProperty("patient");h.DataA["chkHighResSelection"]=this.platform.ApplicationTags.hasOwnProperty("patient")?false:this.platform.GetSetting("highResIsActive")||false;h.DataA["actionCheckHighResSelection"]=(e,t)=>{var i=e.target;if(i.checked){this.platform.Configuration.QualityMode="Mixed";this.platform.SetSetting(40,"highResIsActive","true")}else{this.platform.Configuration.QualityMode=this.platform.GetSetting("QualityMode")||"Low";this.platform.SetSetting(40,"highResIsActive","false")}};h.DataA["actionBtnConnect"]=(e,t)=>{let o=i.Form.GetFieldFromForms(h.DataA,"urlLocalXC");let n=o.htmlElement.value;PlatformSettingsController.ConnectToSmartLink(n,this.platform)};h.DataA["actionBtnConnectIP"]=(e,t)=>{var showWindowIp=()=>{if(sessionStorage["serviceIpCache"]!==undefined){var e="location=yes,resizable=yes,scrollbars=yes,status=yes,width=500,height=300";var t="https://"+sessionStorage["serviceIpCache"]+":8889"+"/connect.html";var o=window.open(t,"_blank",e)}else{i.Toaster.ShowToast("Ip invlid "+sessionStorage["serviceIpCache"],i.Colors.BelizeHole,3)}};if(sessionStorage["serviceIpCache"]!==undefined){showWindowIp()}else{i.Loader.Show();this.platform.CacheConnect.BlockTokenRequest=false;this.platform.CacheConnect.GetToken((()=>{i.Loader.HideAll();showWindowIp()}))}};h.DataA["actionSelectTheme"]=(e,t)=>{var i=t.GetField("selectTheme");this.platform.SetSetting(40,"theme",i.htmlElement["value"]);this.platform.CurrentView.SwitchTheme()};h.DataA["actionSelectDateFormat"]=(e,t)=>{var o=t.GetField("selectDateFormat");i.Loader.Show();this.platform.SetSetting(40,"dateFormat",o.htmlElement["value"],(()=>{location.reload()}))};h.DataA["actionSelectOnDoubleClick"]=(e,t)=>{var i=t.GetField("selectOnDoubleClick");this.platform.SetSetting(40,"onDoubleClick",i.htmlElement["value"])};var f=[this.platform.SettingsSubView.Pane.DataA];var g=(new t.ConfigPlatformForm).Create(n,f);g.forEach((e=>{h.SectionsViewer.push(e)}));if(sessionStorage["standAloneOnline"]!=="active"){let e=i.Form.GetFieldFromForms(this.platform.SettingsSubView.Pane.DataA,"chkSmartLinkConnectionAutomatic");e.htmlElement.nextSibling.style.display="none"}if(sessionStorage["isSuperAdmin"]||!i.Utils.CheckNotAllowTag(["patient","guest"])||sessionStorage["technology"]!=="Efferent"){g[0]["childNodes"][0].style.display="none"}var C=i.Form.GetFieldFromForms(h.DataA,"chkHighResSelection");if(C){if(this.platform.ApplicationTags.hasOwnProperty("patient")){C.labelhtmlElement.style.display="none"}}h.RebuildElementsInConfig()};var a=i.PlatformContext.PlatformUri+"/fhir/Device";var r=new e.Frontend.FhirClient.FhirCall(a,"GET");r.FuncOk=e=>{i.Loader.Hide();setSystemSettings(e)};r.FuncError=e=>{i.Loader.Hide();setSystemSettings(null)};i.Loader.Show();r.Send()}static GetModeConnectSmartLink(e){var t=e.GetSetting("urlLocalRepo")!=="undefined"&&e.GetSetting("urlLocalRepo")!==undefined?e.GetSetting("urlLocalRepo"):i.Utils.StrToBool(e.GetSetting("urlLocalRepo"))||false;var n=e.GetSetting("automaticSelection");var a=n!==undefined&&n!==null?i.Utils.StrToBool(n):false;if(a){return o.Automatic}else{if(t)return o.Manual;else return o.None}}static ConnectToSmartLink(e,t,o){let n=e;if(n!==""){if(i.Utils.IsURL(n)){i.Loader.Show();t.CacheConnect.BlockTokenRequest=false;t.CacheConnect.GetToken((()=>{i.Loader.HideAll();if(sessionStorage["serviceIpCache"]!==undefined){if(o)o(true);var e="location=yes,resizable=yes,scrollbars=yes,status=yes,width=500,height=300";var t=window.open(n+"/connect.html?localIp="+sessionStorage["serviceIpCache"],"_blank",e)}else{i.Toaster.ShowToast("The cache server's ip cannot be obtained",i.Colors.BelizeHole,3)}}))}else{i.Toaster.ShowToast("DNS invalid",i.Colors.BelizeHole,3)}}}}t.PlatformSettingsController=PlatformSettingsController})(t=e.PlatformClient||(e.PlatformClient={}))})(Efferent||(Efferent={}));var Efferent;(function(e){var t;(function(t){var i=e.Frontend.WebClient;var o=i.Utils;var n=i.DOMUtils;var a=e.Frontend.FhirClient.FhirCall;class ProfilePane extends i.SubView{constructor(e,r){super(e,r,"PlatformLanguage");this.ResourceBag=t.ResourceBag;const l={optionsCountryCodes:n.CountryCodes.map((e=>e.iso)),valuesCountryCodes:n.CountryCodes.map((e=>e.code)),actionUpdateProfile:()=>{if(this.HumanNameControl.NameIsSet()){if(o.ValidateEmail(d.value)){if(h.value.length>=7){i.Loader.Show();const e="+"+c.value+h.value;r.UserProfileData["name"]=this.HumanNameControl.GetHumanNameObject();sessionStorage["practitionerName"]=r.UserProfileData["name"][0]["text"];r.UserProfileData["telecom"][0].value=d.value;const t={system:"phone",value:e,use:"work"};if(r.UserProfileData["telecom"].length===1){r.UserProfileData["telecom"].push(t)}else{r.UserProfileData["telecom"][1]=t}const o=i.PlatformContext.PlatformUri+"/fhir/"+sessionStorage["practitionerId"];const n=new a(o,"PUT");n.BodyData=JSON.stringify(r.UserProfileData);n.FuncOk=e=>{if(e!==""){i.Toaster.ShowToast("Profile updated.",i.Colors.Emerald,3);i.Loader.Hide();this.CloseSubView()}};n.FuncError=e=>{i.Toaster.ShowToast("Could not update profile.",i.Colors.Alizarin,3);i.Loader.Hide()};n.Send()}else{i.Toaster.ShowToast("Please input a valid phone number.",i.Colors.Orange,3)}}else{i.Toaster.ShowToast("Please input a valid email address.",i.Colors.Orange,3)}}else{i.Toaster.ShowToast("Please fill all the inputs.",i.Colors.Orange,3)}}};this.Element.classList.add("profilePaneContainer");(new t.UserProfile).Create(this.Element,[l]);const s=l["forms"][0];const d=s.GetField("emailInput").htmlElement;const c=s.GetField("selectCountryCodes").htmlElement;const h=s.GetField("phoneNumberInput").htmlElement;n.ForceNumbers(h);this.HumanNameControl=s.GetField("HumanName")["controller"];this.HumanNameControl.SetFields(r.UserProfileData["name"]);for(let e=0;e<r.UserProfileData["telecom"].length;e++){if(r.UserProfileData["telecom"][e].system==="email"){d.value=r.UserProfileData["telecom"][e].value||""}if(r.UserProfileData["telecom"][e].system==="phone"){if(h.value){break}else{const t=r.UserProfileData["telecom"][e].value;if((t===null||t===void 0?void 0:t.indexOf("+"))>-1){const e=n.GuessCountryCode(t);h.value=e["phoneNumber"];c.value=e["code"]}else{h.value=r.UserProfileData["telecom"][e].value||""}}}}this.SetButtons([]);this.SwitchTheme()}OnWindowResize(e,t,i){super.OnWindowResize(e,t,i)}}t.ProfilePane=ProfilePane})(t=e.PlatformClient||(e.PlatformClient={}))})(Efferent||(Efferent={}));var Efferent;(function(e){var t;(function(e){class ResourceBag{}ResourceBag.PlatformClientCss=`.worklistPane{overflow:auto;width:100%}.worklistPane .rowButtons{position:absolute;width:80px;height:25px;margin-top:2px;margin-right:15px}@media(max-width: 950px){.worklistPane .rowButtons{position:initial !important}}.worklistPane .workListUl{display:none;list-style:none;margin:0;padding:0}.worklistPane .workListUl li{border-bottom-color:#34495e;padding-bottom:10px;border-bottom-style:solid;border-bottom-width:1px}.worklistPane .WorklistListLi table td:empty{content:" ";font-size:16px;display:inline-block}.WorklistGridTr td:first-child{position:relative;white-space:nowrap;overflow:visible}.WorklistGridTr .tagRow{position:absolute;width:100%;left:0;top:2px;padding-left:.5em}.WorklistGridTr .tagRow:before{content:"";position:absolute;border-left:dashed 1px;border-bottom:dashed 1px;border-top:dashed 1px;background-size:100% 100%;width:7px;display:block;z-index:1;height:22px;top:12px;left:4px}.WorklistGridTr .tagRow+.contentDiv{margin-top:20px;margin-left:12px}.workListTable{display:table;border-spacing:0}.workListTable.panel{display:table}@media(min-width: 20px)and (max-width: 949px){.workListTable.panel{display:none}}.workListTable thead th{color:#fff;text-align:left;white-space:nowrap;position:sticky;top:0px;z-index:2;padding:0px 5px 0px 5px;border-left:1px dotted;margin-bottom:5px;vertical-align:middle;cursor:pointer;background-color:var(--color-background-secondary)}.workListTable thead th span img{width:16px;margin-left:5px;vertical-align:middle}.workListTable thead th:first-child{border:none}.workListTable tbody tr{height:auto}.workListTable tbody tr.selectable{background-color:#bdc3c7}.workListTable tbody tr.selectable td{vertical-align:bottom}.workListTable tbody td{vertical-align:bottom;line-height:1.2;overflow:hidden;padding:5px 0px 5px 5px}.workListTable tbody td div{height:20px;overflow:hidden;word-break:break-all;text-overflow:ellipsis;white-space:pre;width:max-content}.workListTable tbody td div.tagRow{overflow:visible}.workListTable tbody td:first-child .contentDiv{margin-left:12px}.worklistRelatedPane{overflow:auto;background-color:#2c3e50}.worklistRelatedPane .workListUl li{border-bottom-color:#2ecc71}.worklistRelatedPane .workListUl li table.selectable{background-color:#bdc3c7}.worklistRelatedPane .workListTable thead th{display:table-cell;text-align:left;margin-bottom:5px;vertical-align:middle;padding:5px 1px 5px 1px;cursor:pointer}.worklistRelatedPane .workListTable tbody tr{display:table-row;margin-bottom:5px;border-collapse:separate;height:32px}.worklistRelatedPane .workListTable tbody tr.selectable{background-color:#bdc3c7}.worklistRelatedPane .workListTable tbody td{padding:2px 1px 2px 1px}@media(min-width: 950px){.workListTable{display:table;width:100%}.worklistPane .workListUl{display:none;list-style:none;padding:0}.worklistPane .workListUl li{margin-bottom:20px;padding-bottom:10px;border-bottom-style:solid;border-bottom-width:1px}.worklistPane .workListUl li table{display:table;width:99%}.worklistRelatedPane .workListTable{display:table;width:100%}.worklistRelatedPane .workListUl{display:none;list-style:none}.worklistRelatedPane .workListUl li{margin-bottom:20px;padding-bottom:10px;border-bottom-style:solid;border-bottom-width:1px}.worklistRelatedPane .workListUl li table{display:table;width:99%}}@media(min-width: 20px)and (max-width: 949px){.workListTable{display:none;width:100%}.tagSpan .tag{bottom:3px;left:0px}.worklistPane .workListUl{display:block !important;list-style:none;margin-left:0;margin-top:0}.worklistPane .workListUl li{margin-bottom:5px;padding-bottom:5px;border-bottom-width:1px}.worklistPane .workListUl li table{display:table;width:99%}.worklistPane .workListUl li table.selectable{background-color:#7f8c8d}.worklistPane .workListUl li table tr.toHide{display:none}.worklistPane .workListUl li table tr td{padding-top:0;padding-bottom:0;margin-top:0;line-height:1;margin-bottom:0}.worklistPane .workListUl li table tr td:first-child{font-size:11px;min-width:104px;padding-right:2%;width:20%}.worklistPane .workListUl li table tr td:last-child{font-size:14px}.worklistRelatedPane .workListTable{display:none;width:100%}.worklistRelatedPane .workListUl{display:block !important;list-style:none;margin:0;padding:0}.worklistRelatedPane .workListUl li{margin-bottom:10px;padding-bottom:10px;border-bottom-width:3px;border-bottom-style:solid}.worklistRelatedPane .workListUl li table{display:table;width:99%}}.worklistFilter{padding:10px;overflow-y:auto;overflow-x:hidden;display:none;width:100%}.worklistFilter .section{position:relative;vertical-align:top;margin-right:20px;margin:2px;padding:3px}.worklistFilter .section .block{display:block;margin-bottom:10px;position:relative}.worklistFilter .section .block div h2{margin-top:0px !important}.theme-light .workListTable tbody tr:not(.selectable):hover{background-color:#fff}.theme-dark .workListTable tbody tr:not(.selectable):hover{background-color:var(--color-background-secondary)}.wrap-thumbnailPane{background-color:#34495e}.row>.wrap-thumbnailPane{width:100px;height:unset}@media(min-width: 600px){.row>.wrap-thumbnailPane{width:130px;height:unset}}.column>.wrap-thumbnailPane{height:100px;width:unset}@media(min-width: 600px){.column>.wrap-thumbnailPane{height:130px;width:unset}}.thumbnailPane{display:inline-flex;gap:5px;background-color:#34495e}.thumbnailPane.hasScroll .totalImagesCounter{right:7px}.thumbnailPane .verticalPosition{display:block;margin:10px auto;padding:1px}.thumbnailPane .horizontalPosition{display:inline-block;margin:10px 10px 1px 10px;padding:1px;vertical-align:middle}.thumbnailContainer{display:flex;position:relative;margin:7px;gap:10px}.thumbnailContainer.row.gap>*+*{margin-left:10px}.thumbnailContainer.column.gap>*+*{margin-top:10px}.ThumbnailItem{background-color:#2c3e50;width:auto;flex:0 0 90px;width:90px;height:90px}@media(min-width: 600px){.ThumbnailItem{flex:0 0 116px;width:116px;height:116px}}.ThumbnailItem.thumbnailTags{overflow:auto}.ThumbnailItem .tag{float:left;margin:4px;font-size:12px;padding:4px 4px;border-radius:3px;box-shadow:rgba(0,0,0,.25) 1px 1px 4px}.ThumbnailItem .progress{position:absolute;width:100%;height:50%;left:0%;z-index:1;top:25%}.ThumbnailItem img{-webkit-user-drag:none;margin-top:50%;margin-left:50%;transform:translateY(-50%) translateX(-50%)}.ThumbnailItem .totalImagesCounter{background:#bdc3c7;color:#000;border-radius:10px;width:20px;height:17px;line-height:15px;text-align:center;font-size:9px;vertical-align:middle;display:table-cell;position:absolute;padding-top:3px;bottom:0;right:0;cursor:pointer;z-index:10}.ThumbnailItem .totalImagesCounter:hover{transform:scale(1.5);background-color:#c0392b;color:#fff}.ThumbnailImage{width:100%;height:100%;z-index:0;overflow:hidden}.ThumbnailImage img.th-landscape{height:100%}.ThumbnailImage img.th-portrait{width:100%}.ThumbnailImage.flyout{margin:0}.subThumbnailContainer{display:flex;gap:10px;align-items:flex-end}.subThumbnailContainer.row.gap>*+*{margin-left:10px}.subThumbnailContainer.column.gap>*+*{margin-top:10px}.subThumbnailContainer.column{margin-top:-2px}.subThumbnail{display:flex;flex:0 0 60px;max-width:60px;max-height:60px;position:relative}.subThumbnail img{overflow:hidden;touch-action:none;user-select:none;-webkit-user-drag:none;-webkit-tap-highlight-color:rgba(0,0,0,0);outline:none}@media(min-width: 600px){.subThumbnail{flex:0 0 86px;max-width:86px;max-height:86px}}.showMoreSubThumbnail{position:absolute;cursor:pointer}.showMoreSubThumbnailHorizontal{top:27px;right:-6px}.showMoreSubThumbnailVertical{bottom:-6px;left:27px}.ThumbnailMenu{position:absolute;display:none;z-index:99999;background-color:#2c3e50;font-family:Lato,Helvetica,sans-serif;font-size:10.5px;width:100%;height:100%}.ThumbnailMenu .optionLabel{color:#ecf0f1;position:relative;margin:10px;text-align:left;cursor:pointer}.ThumbnailMenu .panel .container{display:block}.ThumbnailMenu .panel .elements{display:inline-block;position:relative}.ThumbnailMenu .layout{position:relative}.ThumbnailStudySeparatorV{width:100px;line-height:5px;margin:0 auto;background-color:#1abc9c}.ThumbnailStudySeparatorH{width:5px;height:80%;margin:11px 0;background-color:#1abc9c}html,body{height:100% !important;width:100%;overflow:hidden}.mainViewer{position:relative}.relatedStudiesPane{display:none}.timeLineRelatedPane{width:100%;height:100px}.viewportPane{width:100%;height:100%;position:relative;z-index:2}.viewportPane .viewportElement{position:relative;border-style:solid;border-width:2px;vertical-align:top}.viewportPane .viewportElement:focus{outline:none}.SpaceViewer{width:100%;height:100%;position:relative;display:flex}.flyout{display:none;position:absolute;z-index:90000 !important}.handCursor{cursor:pointer}.MessageBar{font-family:Lato,Helvetica,sans-serif;font-size:13.5px;background-color:#2980b9;color:#ecf0f1;z-index:100;width:100% !important;position:absolute;top:0;left:0;display:none;z-index:120;height:auto !important}.MessageBar .InnerMessageBar{display:flex;justify-content:space-between;margin:10px;gap:10px;height:auto !important}.MessageBar .InnerMessageBar .floatLeft{flex:1 100%}.MessageBar .InnerMessageBar .floatLeft .block>div{display:flex;flex-wrap:wrap;gap:4px}.MessageBar .InnerMessageBar .floatLeft .block>div>*{flex:1 100px}@media(min-width: 768px){.MessageBar .InnerMessageBar .floatLeft .block>div>*{flex:1 200px}}@media(min-width: 768px){.MessageBar .InnerMessageBar .floatLeft .block>div{flex-wrap:nowrap;gap:10px}}.MessageBar button{color:#ecf0f1;background-color:#e74c3c;height:32px}.MessageBar .floatRight{display:flex;gap:8px}.spinePane{display:none;z-index:1900;overflow-y:auto;overflow-x:hidden;margin:0 0 0 12px}.spinePane .btnClearAll{display:block;padding:5px;margin-top:20px}.barSpineElements{width:auto;display:-webkit-box;display:flex;margin-bottom:2px;flex-direction:row;-ms-flex-direction:row;flex-wrap:wrap;-ms-flex-wrap:wrap}.barSpineElements button{margin:2px 5px 2px 0}.configPane{color:var(--font-color);background-color:var(--color-background);display:none;z-index:1900;overflow-y:auto;overflow-x:hidden;width:100%}.configPane .section{position:relative;vertical-align:top;margin:10px}.configPane .section:not(:only-child){display:inline-block}.configPane .block{display:block;flex-grow:1;margin-bottom:10px}.configPane .tabs{margin:10px;padding:0;position:relative;display:flex;flex-wrap:wrap;gap:10px}.configPane .tabs.gap>div+div{margin-left:10px}.configPane .tabs>div{padding:0;margin:0}.configPane .content{overflow-y:auto;overflow-x:hidden}.configPane .content .wrapContent{display:flex;flex-direction:column;height:100%}@media(min-width: 600px){.configPane .content .wrapContent .marginLeft{margin-left:20px}}@media(min-width: 600px){.configPane .content .wrapContent{flex-direction:row}}.configPane .usersGrid{margin-top:20px;position:relative}@media(min-width: 950px){.configPane .usersGrid{margin-right:max(210px,36%)}}@media(min-width: 1281px){.configPane .usersGrid{margin-right:50%}}.caseStudyPane{display:none;z-index:1900;overflow-y:auto;overflow-x:hidden}.caseStudyPane .section{position:relative;vertical-align:top;display:inline-block;margin:2px;padding:3px}.caseStudyPane .section .block{display:block;margin-bottom:10px}.tabs .tab{margin:0 10px;max-width:200px}.tabs .tabActive{margin:0 10px;max-width:200px}.sharedSection{width:240px;z-index:91;position:absolute;padding:10px;display:flex;flex-direction:column}.mainPage{position:relative;margin:0;display:-webkit-flex;display:flex;width:auto;flex-direction:column;overflow:hidden;height:100%}@media(min-width: 768px){.mainPage{margin:10px;height:calc(100% - 20px)}}.headerSection{position:relative;display:flex;flex-flow:row nowrap;color:#fff;background:var(--color-background-secondary)}.editToolbarSection{display:flex;flex-direction:column;gap:4px;display:none;gap:5px;background-color:var(--color-background-secondary);border-bottom:1px solid var(--color-background);box-shadow:0px 1px 1px rgba(255,255,255,.1607843137)}.editToolbarSection .margin{margin:5px 10px;display:flex;justify-content:space-between}.editToolbarSection .mainButtonsContainer{display:grid;grid-template-columns:repeat(6, 1fr);overflow:hidden;border-radius:5px}.editToolbarSection .mainButtonsContainer>div{height:25px;padding:1px 8px;cursor:pointer;display:flex;align-items:center;justify-content:center}.editToolbarSection .mainButtonsContainer>div svg{transform:scale(0.8)}.editToolbarSection .actionButtonsContainer{display:flex;gap:4px;align-items:center;margin-left:auto;margin-bottom:0}.editToolbarSection .actionButtonsContainer button{width:80px;height:28px}.theme-light .editToolbarSection{border-bottom:1px solid #838e8f;box-shadow:rgba(255,255,255,.16) 0px 1px 1px}.theme-light .editToolbarSection .mainButtonsContainer{border:1px solid rgba(255,255,255,.4117647059);box-shadow:0 1px 0px rgba(0,0,0,.2705882353)}.theme-light .editToolbarSection .mainButtonsContainer>div{border-left:1px solid rgba(255,255,255,.4117647059)}.theme-dark .editToolbarSection .mainButtonsContainer>div{background:#2c3d4f;border:1px solid #212d3b}.bodySection{width:100%;display:flex;gap:4px}.bodySection.blockedByEditToolbarPane::after{display:flex;position:absolute;top:0;left:0;right:0;bottom:0;content:"Edit toolbar mode";background:var(--color-background);z-index:10;border:1px solid #33485e;align-items:center;justify-content:center;font-size:24px}.functionsSection{display:flex;flex-flow:row nowrap;padding:5px;margin-top:20px}.functionButton{flex:1;margin-left:20px;padding:10px;width:120px;height:40px;border-radius:5px;-webkit-border-radius:5px;text-align:center;cursor:pointer}.headerSection #toolbarHeader{flex:1 80%}.userInfoHeader{z-index:100;font-size:10px;text-align:right;margin-right:8px;margin-bottom:3px}.userInfoHeader span{font-size:9px;white-space:nowrap}.userInfoHeader .userEmail,.userInfoHeader .organizationName{max-width:250px;display:inline-block;text-overflow:ellipsis;white-space:nowrap;margin-right:3px}.userInfoHeader .userEmail,.userInfoHeader .organizationName{font-size:9px;margin-right:0px}.headerSection #infoUserHeader{text-align:left;z-index:100;font-size:12px;margin-top:3px;min-width:210px;max-width:300px}.headerSection #LogoutUserHeader{text-align:right}.headerSection #AdminUserHeader{flex:3 1%;min-width:34px;text-align:right;display:none}.logoutButton{right:0}.buttonsContainer{display:flex;flex-direction:row}.buttonsContainer button{margin:0 5px}.panelContainer{display:block;margin:10px 0 0 0}#AdminContentBox{position:absolute;right:0;padding:10px 10px 8px 10px;display:none;z-index:2000;border-radius:0 0 5px 5px;background:#7f8c8d;box-shadow:rgba(0,0,0,.25) 0px 5px 5px 0px}.TagPane{position:absolute;display:flex;flex-direction:column;left:0;right:0;top:55px;color:var(--font-color);background:var(--color-background);z-index:100}.SpaceViewer~.TagPane{bottom:2px;top:63px;right:0}.dottedBorder{border:1px dotted var(--color-border-dotted)}.theme-light .invert{filter:brightness(0.5)}.resourceListBoxSearch img.invert{filter:brightness(1)}`;ResourceBag.UnavailableCloud32Png="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAq1JREFUWAntlktIVFEYx+eWCjGDRQVBUaA9di1sMAttE24CF5Kr2kYQAxJBi9q0CFqEEEjhKlq0CbJFC3ERMTKraCFThA24SHtA9EKF7GlOv7957swZ55479yYa2IEf5/H9v8ece869k0j8K61YLB6GulWph8RJeAuDq1lEC8k/rbkivMpnzg60sPYQsnDC87y5So2Zo61nvA/2wx54DWNQwG+WPl5TERD4OLDVwXn4AGrqH8ML+AmzcAmS8SrAC2dTxF3G/u1gvAVGYBpuwIHyJMxTkAEd6gJoZ+I1nK0imDfCE3gOza6o2DdDFiZhq0tb1YaTku2CNOjXaidugQJuq+pUsYhOuzEG9ypM7ikO7fASnoHeEW2gItS63N62Ff0hmId22xIwQ3gEvsE12GBkjE0R1pkwdleP7wO47dL4NoSjcvAXygas63HodkQqAv1ZmCgLVX2IqAm+wunqiuDbEaTXOvGOw5dADcb1cAG09bo6bYHiPwGt2+HSyka8k/ALrkMHrLN8WBiAGdD9tY2WsjRBV3MRaFuhDx7BD8jB9oVoDHTidUqPlsLXNsLHFDHI2H9ZubzR7YWnoLPWoO2R85DLyWXDN04RO/HTte5VAe/hlCtJmA3/OEVcxS+vArT9x8KShNmjFoG+G77rwL2DprAEYXY+v3k0naCzdIfgYWeiAd2cdkDvd31Kl/w3QBC5Eaemx4HuJuRUgE6l7n9v5GwBDsRyFoH9IOg69iyEYHAG9KLoh1RA3EjLxFlSBGv1cA6m4D54/rYz6SbDAGyEAryCIsRp8zhdhE2gv3fjMAOtoA9cP1zm3Hz2C2BBj0N/ofQaTsNusOzMo7Q3iK+Akg6DEmdgiMQf6Veu8cPM44j0FV3WCv8XYbZzcSfy9DvM2or3JP+bw7289f4GMP4YiykG5wwAAAAASUVORK5CYII=";ResourceBag.IconEditPng="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAARCAYAAADQWvz5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACmSURBVHgB7ZTRDYIwEIZ7xgE6AptYN3EEnUA2kBEcwREcwQ3UCWSD+v/hJ+kDkDbwQsIlXziu7Zfrw9VcYcQYPT4n/T7M7MPEXEFI8gQ/8AUHcOxl2RLwAnVSa8CZ+S5Xok54lTpZYr3NcQx2ovqV9UUk6nSTrFeiA/fZEh16g2qupKIoyW/FEsQeBOB7metmKmCmWsmD9kxFQxHn5ULByHOQ05n/AwwTCjNMfFP4AAAAAElFTkSuQmCC";ResourceBag.IconTagButtonPng="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACTwAAAk8B95E4kAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAD4SURBVFiF7Zc9SgRBFAarB1YFMfYvFzUw1Tt4EBUD8S7iTYT1BOqKYiKKF1CTTURYMCiDeQuNs2YzO0l/Sfejgyq6k/4goi6ox+q9Orb9jNWReqQOyKNuqo8dQP/Lg7oBkNQl4A7YC5834Ap4pd1sA4fAVsxPwAHqeWZ20bieFmP9zJcZ7wzrN1d97hKeSQzUl2DeVsBOnF2nlH66FgjGMMbdCliO4aNreJb3WFeqOUJnpggUgSJQBIpAESgCRaAIVMB37NfmyF2P9QvrutTXt/wG9bTHYnKS1EVgRLOafbbMX6VZzfanZr2V07/XM63nkw6gE2fU81+dp1zcOTFgyQAAAABJRU5ErkJggg==";ResourceBag.Icons8Advertising32Png="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAOoSURBVFhH3VZJaBRBFG0VBUURFXFBVERUIgHTVZNMFgk6vYRE4yluiCKe4gLBCHpQgoILiCCioBcJiojJTQQXCCKIiAaXgwt6EkWJaBSjTqa77fb9mj+Jk56kA87kkAfFzH+1/Pd//aoubdTDs/TNrikuBNVFk5kaOTim3ImWciz5zbH0RqZHBik7thzOe8mxY4pLjiWuclfhEawRk1xTPofjm4GmjUEGmmC/4u7CImjRxiLyK3D+3q9ZMZM4z5IbIOK7GlBIBEKMV87hDCkvZVpzLX2Va8nAj8cnMpV/pGxdR7U/gvMu+s+0Qq8llpGAwBDzmcoPgoaGcY4hquC0FSn38Nvm2/oc7u4DOSYBvbZcylQYVCyuqVuo2makb/8g7QCK6QQWOw9nHSrVace3XFsavFQIvhWfTgJSCb2YqWyovbPkbThIIo3PMLgz1EzxAr+Ba4l7cHoNQo57dmy9n4jN4GUGBTIwleZiXiVT2YDzJnR+StplC5kKgdTTIrQYU8OGX18xRQkwZDVT2YCAdkR2ls2c+B8BBCWAbkRT3gltBcgblFI2cyIfArCNJ7HN1yGki+qCu0ZGABWra+t1QUPRBIj44hliE3eNYAZIAK5p+Ot2bbGOu1QNtFJq2MyJvNQAbknU2mNsxWsSwl0qPZUQ4KLzGMRU4C4QAxvd52oRO1buGyVz6RLi6ZGg74PKAB1lU54JamOzuasflBKI+KAGDqNBaA9+70P8waRVspiXyQnKmppj6yuZyg3H1MuUA1OuDeqKp2Ua+EOknv77q8tmqbvdkPUYewRZe4LU/oGg9mRCLuKlstAvIFbO1OCAowdY9BybCtiCRnBv2AzBMfQ4RNxF++VZYivTfcgICJ3/XMA27MFCH9lUSFlyOyJ8x2ZOpB8eYjfVEv0yrQAB0R+jDOgppQYnYkuYUg9LiOpmc0h4pr6Nzrxnyi1MpT/VWDPXlzKE9ItG/EiZYgdT6QIFx2YkkK19aD8zEWP7TBJAHz01IAqY3IFauMgm9lhUqQjwUWFqSKjtwJ2POQ8pIGRjIwL4yt3RgOKjOAnP2dTo3JIAug+YioRfW7IAgfSomrJkC+Z3clc06BhSMf37hkNG6LnVQXc5U5HgovwN5y8R1Gmmo9EXMY4XU5pfUzoPaf0MEU1MDQtY5xQd4YHvxEggC28R9WE2FRDNZQhoY7OwQLS7aBsggp9o4insJOqgmYcUHnR3o3r3wrF6lNJxpKrm7tEATfsLi6lWD7xVeu4AAAAASUVORK5CYII=";ResourceBag.Icons8CaduceusFilled50Png="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAADFwAAAxcBwpsE1QAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAATYSURBVGiB1ZptaFZlGMf/9zZdk17c5kullJHGwolKUdoXo5A+ZDUIlMIshF5p5EoqIlxvOsIgohkIfdCI0gihCUpoQQsxl9mHJdoUKp1BJnOaTt1yvz7c99MuT2fbeeZ5Oo9/OJz7XPd1rpdzv17XfaQ8AYwFlgHfAMeALuBLYFKEbxTQBPwariZgVITnRuA7PM4D7cDrwMR87crHgTLgNeA08TgIjDH8TTE8q0z95cBvg8g6C7wNXJa2E1PMlxsK9eadIzH1naa+PoG8fcCsJDaWJHBinqQ2SbcnkDd7GNmWNj2BvBpJO4CFwzEO6QjwnKRtksYnUCpJXaa8Lqbe0o4llDlG0gZgNVCW8B0PYDzwWYKmj6LOyMgN9qPhumCwA/eMQH4rMC2JA6OBx/GzUb44CyRtOQHXA+dGoOcM0AiMtfIc8IykakkzJM2TNCGpMTE4Lt8V651zR4FbJO2T5CRNcs51ALWSmiXNkVR+Ebp6JG2XdEDSGQXv0sZsSQJ+NLSWQLu3APqaSyS9KenTi/gycagwXy2HvnAvTVnXFknPlzjn+p1zD0uaL2mNpFZJf45A4NeSFslPq22BdsbU94b7Vkm1kh4KuvJFl6RvJa2VtEDSfc653lhOYDLwDrAF2M7gqznA38Cjg8hpMXwfDcLzGNA3hPy/8Nuh3cBG4KY4ObHzsnOuU9Jyo+wKSbfKf+GJkqZKape0UVKjc249UC1phaS7wmsf6sKu1Qs0SFoqCfkWfMM5tw6okNQoabGkWZL2SjohPxm0OedOx9mZGoDFQCl+2t4V8zW/MuWtMfU78etNKWYNygzA/ca4buAwsBL4wNDfB1aFum5DX5C1/f8CWGIMW2boV+K3/HuB1Yb+oOFfko3VMQBqIl3mC2BuhKcq3O+ItMjceKkZAWiOGQN7gQZgnOGbyUBIsBtwWdr9H4QBuxLojXGoJ4yXGwJvGfAicF3Wdg8KoBb4mPgNYU9ooWHjoKIBcA3wKnAoxqFN5Btb/N8AnsCEp/g15ingeMSZ5UPJyRTAbUB/MLQVmGLqavABVg4daepOu6/WycceklQl6RB+5Z7unNuvC3fZk9NUnLYjFaa8xznXL+lmSecCrdrUH0lZd3oAnjRd5w9M0i50Ozs1v5elrUMCmBCm2Bx+MmtHFX4bDnCqqNcQyaeQIrNTNyYvBSwFHsnSxsQAVsSsHWvxccelBaAujBOL9lxXK3oADh9RCqgG1kecOQxMzdrOYYFP8HUCDxjafOB348wPwOgs7RwWQIcx2AZT08JslcOiNPUWYhc6xZT35wrOuQOSdpq6VMdKIRzpNOWFkZnqhCmnutdKHcBLkcF9ELg71DngBXzkWPRjZBSwOeJMPz4ULg88lVnbmQj4UPZl4GTEoW1F3xJxwEeJ0QOjp7O2KzGADcAc87zGOLIjS9vyAv5U6TzwVni+2jjSXQidhcpmdATZuVY5FS5p4Jyk+IHfpoD/K+KqQLsW+BzYlLV9iQGUAJ8EZ/YAM03duKHeLSrgk9elwCv4RF0f/ni6uHNZUeBD2i2hO80Avg+t08IllmXMJanvDM/lwM+BNmeY10eEQn2dXeH+Lj7JUKmB30BOFkhn+sD/AvJLaIHV+I0iwIasbcsb+PRPA/6EuBJ4Fn9gWhD8A3T13HNx2LigAAAAAElFTkSuQmCC";ResourceBag.Icons8Search32Png="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAACHUlEQVRYhdWWO2gUURSGv7sbEi1ESAxBURHMWoit2BlFDGihEHfFFHZiLCXaWFsIWipBOyubWAQNpAkIguCjM1hI8NXEB66vwgXd+FnsVUfF7O7ssFlPM1Oc//wfZ86ce+F/DHV1O83y6kH1qvpc/WItKuq8OqHuSVs/1DHfB1wANgOzwAzwAigD/UAB2A8MAfeB8RDCvbQwSeOgnlWr6mV1bZ38gjoZu3MiC4CL6if1QJO6sQgx3or5sVhkd0r90di54TTiXvW9ejqNeaLORBzQ7maF59QnTQv/rrNG/aCONSt8pp5qxTxR65J6qxnBtvh/FzICGFa/1ltaucR7AaiEEOazAAAeAl3ApkYBBoDXGZkDvAEWgXWNAlSAlRkC9AD5WLchgAWgv9U/IBHr4/NVQ9lqXxyavVm4x634Ts0vlfezAyGEMnAHKGUBABSBmRDCYsMKtRjX8GArzupO9Zu6vVlhUO+qs2pXSvNV6iN1Mo0edVAtq1fUXH3Fb9oV6rT6Uu1LBRALDakf1Ztqb4OajbF7xmE+nBogFtyqPo6n4xl1wz/ytqjn1c/qXDT/AdHaQKvd6kl1IQ7VnHoj3g+n45FrBD2u5tTSHxDFpTyWvBMmQHLADmAXtdU6ALwFngK3gQchBBP5JeAatbOgCoyGEK6naULqUA/56wZdVUfbCtBJECOdCHFkOSCSn2Oq7QARYkSdUnuWBaAj4zvw4Tg4pP5UgAAAAABJRU5ErkJggg==";ResourceBag.Icons8Settings32Png="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAPJSURBVFhH1ZZraI5hHMaHWKaccmwlyyEm5LQikm8OX5gc80EaOYeclVLmUEo+IcfJ9lEt5oNDhLQY4wNyyLFmIoeYs83verr22OvZ++7dWHHVr+f+X///fd/P8X7ulP9SlZWV4+B0DY5DJ6cbX0x2FG5UVVVtE7Q/wDSnG19Mdg02OFR8GTY7/DtiwPlwAfrbCsQVN8WrgEm2VLsXCh2GwsuGqzDUVnKiw0L4AcXwCZYwcRNBO5uj1Mflql8MZdBbMbk02jopjXGF+C3HYUFxXaJwrjvm0FET6mQ+0j7P8R7oeecRN3MX9cmAi/Ad9FLegacwWnUcj+gkYIi7xBfFJ0EvWFNb8jKhCFbgp9mOiFx3avbAEWhvW/3T4SusshVfFPWE90kVJyFOSndRF1VKu4XtxKJYj+EzDLDVYDHGItB71M9WcqLDWShyGJEehQaFXrTDx1VT5FKhgvxaW8lJA9LxASy1FYpcG/zdHjgQ7eewnGYTl4XCPwe7HNYtBtFbOx3eQUvbgchp8pvwDGZAV9A7sx4+kT/s0lD4E+ANpNuKiuRYyIfroE9OV3XQ6VB4esM1efiGVwtvFHyn6xRbgYib45d5zFegxU1rRLBmBCI4AaWwjrqJHHtyjHmueC1BK+B0WxGROwCnHYZirDQYQm4WbIFy4l/vBYZOYKvDWkW+L510FV1tRUROE7xwGFfUXGzICeiu6AR62IqI9DzyTx3GFTWREzgGWnwugZ7zAgq6OR2IWF+G3vb1tmJEXgvOGSiwFQpvOKwB/cb1qL/BcqeDgs4wFXKhEPRjOeV0KLxloLd9pK1Annw16F8wyHYgcm3xvsAtKCBey1FfRqpLoiI5ELR2xzxvT3QINNF+0DPXqqlFS1c1x6Wh8HLgIX1rXaziik76u+10GCN83S3d7nLQX68AYq5c0qT492G1reREh1ZwF/bbapA4Aa0BjyDPVnLSxPCYAdrZarAYZwTokc2wlVgUTnaH0bYC6WrcTCjd9t9rGWsjnjYk3W3FF0UldCjmGOx4OOrFWwBaBbX9HlOdqyn81vizOerRPYHwAvC7EKv/DlvxRVEWHbSHywPtZLQT0v9cP5x9oC3ZYwg/I9pZoAk0ser0CLWt2w4a44Zg3A7uklgUV5+Evl8tHJlOKZdBTiviQFvyVsFt7PDO0NY/5SVoY6MT6OhUcqLDYFjJQJFtFP5rmOlQsfaA+Q5D0Ve3fhPUb/K6xIBaI3IdKtZ+r367nj8RE+p//opJSwRtrYLjnW58MVlv0M+lGv0j4q/t/65SUn4CMmPSTUbzvUAAAAAASUVORK5CYII=";ResourceBag.PlusPng="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgEAQAAACJ4248AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QAAKqNIzIAAAAJcEhZcwAAAGAAAABgAPBrQs8AAAAHdElNRQflCA8TNy6w/8vUAAAC+ElEQVRYw8VXQUsqURS+MwslHCEoE2mTJTmSoMuHUsS0i7ZF/RkRQfQfiPoTtKBFLQU1lyH2A2ZSKJA2gQrV4nxvcZymXlYz06sOuPDce8/3ne/ec+4dSdg0kN8vpL09AU0TUiIhxMqKEPPzPHp/L4RhCPR6Qmo0BM7OJHk0shv7Y2CEQkCpBEwmsG2TCahaBUUiXwCemwNyOdB4bAW+vAQyGWB7G1BVwOfjn6qyL5PhOaY9PQHFIsjrdQZOkQhwdcVBiIBaDYhG7ZOPRoF6ndcCQKcDCgZtLk4mgeGQF+o68OePexVTKcAwONZgAIrHbWRugjeboMVF13v4HDMQAJpNjtnvv6sE77kpe7MJ8ni+Cm6R8HgsEp3OzDMB5HLPsv+HzGcroeuMUSj8Ax4K8WkncrLnQKcDtNv256dSjPH4CKytvRgolZhZreYoq6k5U+L4mIurUpk6/H5uMkROSs01AcRiTGA8BimKAI6OzCbjJJBbApx0t8srDw5kAU1j9+mp00CuTTKxdnZkvliEEKLV+jECJhYSCVkgHOY/t7c/R+DmhpUIhwWXBABSlFlTudTc2uwSBSkKjz88yJZbkmazJXKf6XsHVLZwQXd3rMD6uvPwLqsA0SivHA5lIek6C7C87D5TpzbFgq7LAr0eOzc3f47A1hYn3esJ4PDw1xoR7e//XivGaAT4fFNG1So76/XvJ3BywqvK5ReSRCL8gCQCUin7wdptwH4HBdJps/5hNkBrsFjkQcMABQJOsrIFToEAcH3NGPn8jAler9X1vuNJ1mqZ3fHd2KBgEBgMeOLFhe2n9IeyLywAjcanj1KLRDxukdB1J2fiLXg6bcne7wMbGzYlCwat7SDiZ1QsZh84FrNOuyn70pIz9uT1AoXC820JgBtINgtoGqCqIEXhm01V2ZfNWq8dgNfm8186T8DqKqhSef2N+JmNRkC5/KbUZphkhwQroihC2t0VQtMEkkkhhcOvPs9hGELqdgUaDSGdn0vSZGIn7l8OtM8lHL82nQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMS0wOC0xNVQxOTo1NTo0NiswMDowMIWUvroAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjEtMDgtMTVUMTk6NTU6NDYrMDA6MDD0yQYGAAAAAElFTkSuQmCC";ResourceBag.ProfilePaneCss=`.profilePaneContainer{background:#2c3e50;color:#ecf0f1}.profilePaneContainer input[type=checkbox]+label:before{background-color:#95a5a6}.profilePaneContainer input[type=text],.profilePaneContainer input[type=date],.profilePaneContainer input[type=password]{background-color:#fff;color:#2c3e50}.profilePaneContainer input[type=text]:read-only{background-color:#bdc3c7;border:1px inset #ecf0f1;color:#ecf0f1}`;ResourceBag.PlatformLanguageJson={en:{newPost:"New Post",home:"Home",back:"Back",dashboard:"Dashbd.",events:"Events",messages:"Messages",calendar:"Calendar",resources:"Resources",admin:"Admin",settings:"Settings",logout:"Logout",availableRoles:"Available roles",roles:"Roles",functions:"Functions",views:"Views",log:"Log",more:"More",feedbackTool:"Feedback",platform:"platform",imagingStudy:"imaging study",createCustomer:"Customers",createOrg:"Organizations",createDevice:"Devices",createUser:"Users",refresh:"Refresh",shareTool:"Smart Share",tags:"Tags"},es:{newPost:"Nuevo Post",home:"Inicio",back:"Atrs",dashboard:"Tablero",events:"Eventos",messages:"Mensajes",calendar:"Calendario",resources:"Recursos",admin:"Admin",settings:"Opciones",logout:"Salir",availableRoles:"Roles disponibles",roles:"Roles",functions:"Funciones",views:"Vistas",log:"Log",more:"Ms",feedbackTool:"Opiniones",platform:"Plataforma",imagingStudy:"estudio imagen",createOrg:"Organizations",createDevice:"Devices",createUser:"Users",refresh:"Refrescar",shareTool:"Compartir",tags:"Etiquetas"}};e.ResourceBag=ResourceBag})(t=e.PlatformClient||(e.PlatformClient={}))})(Efferent||(Efferent={}));var Efferent;(function(e){var t;(function(t){var i=e.Frontend.WebClient.DOMUtils;var o=e.Frontend.WebClient;class RolesList extends o.WorklistGrid{constructor(e){var t=document.createElement("div");i.AddClass(t,"worklistPane");var n=new o.WorklistColumn("Role",180,(()=>{}),o.EWorklistSort.None,o.EWorklistFilter.Up);var a=new o.WorklistColumn("Functions",280,(()=>{}),o.EWorklistSort.None,o.EWorklistFilter.Up);var r=new Array;r.push(n);r.push(a);super(r);this.Worklist=t;this.Parent=e;var l=document.createElement("table");l.width="350px";l.setAttribute("class","workListTable");this.Table=l;var s=document.createElement("ul");s.setAttribute("class","workListUl");this.List=s;var d=document.createElement("thead");var c=document.createElement("tbody");this.THead=d;this.TBody=c;this.Table.appendChild(d);this.Table.appendChild(c);this.Worklist.appendChild(this.Table);this.Worklist.appendChild(this.List);this.Parent.appendChild(this.Worklist);this.THead.innerHTML=""}BuildTableHeader(){super.CreateHead(this.THead)}BuildBodyTable(e){this.TBody.innerHTML="";var t=new Array;this.From=1;this.PageSize=30;for(var i in e){if(e.hasOwnProperty(i)){var n=e[i];if(n instanceof Object){var a=new Array;a.push(new o.ItemCell(n["Description"]));a.push(n["Functions"]!==""&&n["Functions"]!==null?new o.ItemCell(n["Functions"].split(",").length.toString()):new o.ItemCell("0"));var r=new o.WorklistRow(n,a,(e=>{if(this.SelectedEntities!==undefined)this.ActionClick(this.SelectedEntities[0]);else this.ActionClick(null)}),(e=>{}),this);t.push(r)}}}this.Rows=t;super.CreateBody(this.TBody,this.List,(()=>{}),(()=>{}));var l=this.Parent.clientHeight;this.Worklist.style.height=l+"px";this.Worklist.style.overflow="auto"}}t.RolesList=RolesList})(t=e.PlatformClient||(e.PlatformClient={}))})(Efferent||(Efferent={}));var Efferent;(function(Efferent){var PlatformClient;(function(PlatformClient){var WebClient=Efferent.Frontend.WebClient;class UserCreationController{constructor(e){this.Platform=e}CreateUserSection(e){const t=document.createElement("div");e.appendChild(t);const i={};WebClient.Loader.Show();const o=new Efferent.Frontend.FhirClient.FhirCall(WebClient.PlatformContext.PlatformUri+"/fhir/PractitionerRole?practitioner:missing=true","GET");o.FuncOk=e=>{WebClient.Loader.Hide();const o=JSON.parse(e);let n=[];let a=[];if(o["total"]>0){for(let e=0;e<o["entry"].length;e++){const t=o["entry"][e]["resource"];n.push(t["identifier"][0]["value"]);a.push(JSON.stringify(t["endpoint"]))}}else{n=["USER","ADMIN"]}i["posibleRoles"]=n;i["valuePosibleRoles"]=n[0];i["actionBtnCreateUser"]=()=>{const e=WebClient.Form.GetFieldFromForms(i,"inputEmail").htmlElement;const t=WebClient.Form.GetFieldFromForms(i,"selectRole").htmlElement;if(WebClient.Utils.ValidateEmail(e.value)){WebClient.Loader.Show();this.createPractitioner(e.value,t.options[t.selectedIndex].text,t.value)}else{WebClient.Toaster.ShowToast("Please input a valid email address.",WebClient.Colors.Orange,3)}};i["actionBtnManagePractitioner"]=()=>{const e="?view=practitionersWorklist";this.Platform.SwitchView(e)};(new Efferent.PlatformClient.CreateUserForm).Create(t,[i]);const r=WebClient.Form.GetFieldFromForms(i,"selectRole").htmlElement;for(let e=0;e<n.length;e++){const t=document.createElement("option");t.value=a[e];t.innerText=n[e];r.appendChild(t)}};o.FuncError=()=>{WebClient.Loader.Hide();WebClient.Toaster.ShowToast("Could not get organization roles.",WebClient.Colors.Alizarin,3)};o.Send()}createPractitioner(email,role,endpointString){var messageValidationEndpointRole="Could not get endpoint role.";try{let evalEndpoint=eval(endpointString);if(evalEndpoint===undefined||evalEndpoint===null){WebClient.Loader.HideAll();WebClient.Toaster.ShowToast(messageValidationEndpointRole,WebClient.Colors.Alizarin,3.5);return}}catch(e){WebClient.Loader.HideAll();WebClient.Toaster.ShowToast(messageValidationEndpointRole,WebClient.Colors.Alizarin,3.5);return}const createPRCall=new Efferent.Frontend.FhirClient.FhirCall(WebClient.PlatformContext.PlatformUri+"/fhir/PractitionerRole","POST");const resource={resourceType:"PractitionerRole",endpoint:JSON.parse(endpointString),identifier:[{system:"http://efferenthealth.com/practitionerRole",value:role}],active:true,practitioner:{reference:email},organization:{reference:"Organization/"+sessionStorage["organizationId"]},code:[{coding:[{system:"http://efferenthealth.com/practitionerRole",code:role}]}]};createPRCall.BodyData=JSON.stringify(resource);createPRCall.FuncOk=(e,t)=>{WebClient.Loader.HideAll();if(t===201){var i={Id:"close",Name:"close",ClassNames:["red"],Text:"Close",Action:e=>{}};const t=JSON.parse(e);if(t.hasOwnProperty("modifierExtension")){for(let e=0;e<t["modifierExtension"].length;e++){if(t["modifierExtension"][e]["url"]==="tempPassword"){let o=t["modifierExtension"][e]["valueString"];const n=new WebClient.MessageBox("** <b>IMPORTANT! DO NOT CLOSE THIS POPUP BEFORE READING</b> **<br><br>The following is the password for the newly created user:<br><br><b id='passwordElement' style='user-select: all'>"+o+"</b><button id='copyToClipboard' class='copyToClipboard'>copy to clipboard</button><br><br>Please keep it in order to login.",[i]);n.Show();const a=document.getElementById("copyToClipboard");a.addEventListener("click",(()=>{document.getElementById("passwordElement");const e=document.createElement("input");document.body.appendChild(e);e.value=o;e.select();document.execCommand("copy");e.remove()}));break}}}WebClient.Toaster.ShowToast("Practitioner role created successfully.",WebClient.Colors.Emerald,3)}else{WebClient.Toaster.ShowToast("Practitioner role already exists.",WebClient.Colors.Orange,3)}};createPRCall.FuncError=()=>{WebClient.Loader.HideAll();WebClient.Toaster.ShowToast("Error trying to create practitioner role.",WebClient.Colors.Alizarin,3)};createPRCall.Send()}}PlatformClient.UserCreationController=UserCreationController})(PlatformClient=Efferent.PlatformClient||(Efferent.PlatformClient={}))})(Efferent||(Efferent={}));var Efferent;(function(e){var t;(function(t){var i=e.Frontend.WebClient.HttpUtils;var o=e.Frontend.WebClient.DOMUtils;var n=e.Frontend.WebClient;const{div:a,span:r,br:l}=o;class UserSectionController{constructor(e){this.platform=e}Initialize(){const e=n.LocalStorage.Get("lastRoleId");const t=sessionStorage["organizationCommercialName"];this.DataUserSection=a({id:"infoUserHeader",children:[a({className:"userInfoHeader",children:[a({className:"userEmail",innerHTML:sessionStorage["fullName"].toUpperCase()}),this.userSectionRole=r({innerHTML:`&nbsp;(${e.toUpperCase()})`}),t?l({}):null,t?a({className:"organizationName",innerHTML:t.toUpperCase()}):null]})]});this.GetSetRoleUser();this.DataUserSection.onclick=e=>{var t=document.getElementById("rolesMenu");if(t===null){var i={x:this.DataUserSection.offsetLeft,y:this.DataUserSection.offsetTop+this.DataUserSection.clientHeight};var a=[];a.push(this.platform.LanguageManager.GetValuesFromDict("PlatformLanguage","availableRoles"));this.userRoles.forEach((e=>{var t=e.id===this.currentUserRole.id;var i=[];i[0]=e.id;i[1]=t;i[2]=JSON.stringify(e);i[3]=e=>{this.currentUserRole=JSON.parse(e);this.ChangeRole()};a.push(i)}));var r=new Array;r.push(a);n.Toolbar.AddDynamicMenuNoToolbar(this.DataUserSection,"rolesMenu",{right:"10px",left:i.x+75+"px",top:i.y+16+"px"},r)}else{if(!o.IsDisplay(t))t.style.display="inline-flex";else{t.style.display="none";o.RemoveItem(t)}}}}AdjustPosition(){var e=document.getElementById("rolesMenu");if(e!==null){var t={x:this.DataUserSection.offsetLeft,y:this.DataUserSection.offsetTop+this.DataUserSection.clientHeight};e.style.left=t.x+75+"px";e.style.top=t.y+16+"px"}}Logout(e){var t=sessionStorage["standAloneOnline"];n.Loader.Show();i.AjaxCall(n.PlatformContext.PlatformUri+"/platform/logout","GET",null,null,(()=>{n.Loader.Hide();sessionStorage.removeItem("token");sessionStorage.clear();localStorage.removeItem("defaultUser");localStorage.removeItem("defaultPass");sessionStorage["pageView"]="logout";if(e!==undefined){e()}else{localStorage.removeItem("jwtUserRemember");localStorage.removeItem("rememberSession");localStorage.removeItem("jwtIdTokenUserRemember");if(!this.platform.CacheConnect.OfflineMode){if(t==="active")location.replace("login.html?cachews=inactive");else location.replace("login.html")}else{location.replace("login.html?cachews=inactive")}}}),(()=>{n.Loader.Hide();n.Toaster.ShowToast("Error in logout operation.",n.Colors.BelizeHole,3);if(e!==undefined){e()}else{if(!this.platform.CacheConnect.OfflineMode){if(t==="active")location.replace("login.html?cachews=inactive");else location.replace("login.html")}else{location.replace("login.html?cachews=inactive")}}}))}ChangeRole(e=true){if(!this.IsAdminOnly()){this.platform.Toolbar.HideButton("toolbarmain.1","admin");if(e)this.OpenMainUI()}else{this.platform.Toolbar.ShowButton("toolbarmain.1","admin")}}IsAdminOnly(){var e=/Admin\s?Only/gi;return e.test(this.currentUserRole.id)}GetSetRoleUser(){var e=n.LocalStorage.Get("lastRoleId");if(e!==undefined){this.GetRoles((t=>{this.userRoles=new Array;var i=JSON.parse(t);for(var o=0;o<i.length;o++){if(sessionStorage["role"]!==""){var n=sessionStorage["role"].split(",");for(var a=0;a<n.length;a++){if(i[o].id===parseInt(n[a])){this.userRoles.push(i[o])}}}}for(var r=0;r<this.userRoles.length;r++){if(this.userRoles[r].id===e){this.currentUserRole=this.userRoles[r];this.userSectionRole.innerHTML="("+this.currentUserRole.id+")";break}}this.ChangeRole(false);this.OpenMainUI()}))}}GetRoles(e){}GetFunctions(e){var t={};t["Authorization"]="Bearer "+sessionStorage["token"];i.AjaxCall(n.PlatformContext.PlatformUri+"/functions","GET",t,null,(t=>{e(t)}),(e=>{n.Toaster.ShowToast("Error getting functions",n.Colors.BelizeHole,3)}))}OpenMainUI(){this.platform.Toolbar.DeselectAllButtons();this.platform.Toolbar.SelectButton("toolbarmain.1","home");this.platform.BodySection.style.flexDirection="row";this.platform.BodySection.innerHTML="";this.GetFunctions((e=>{this.userFunctions=new Array;var t=JSON.parse(e);for(var i=0;i<t.length;i++){}if(this.userFunctions.length>0){var n=document.createElement("div");o.AddClass(n,"functionsSection");for(var a=0;a<this.userFunctions.length;a++){var r=document.createElement("div");o.AddClass(r,"functionButton");r.innerHTML=this.userFunctions[a].id;n.appendChild(r)}this.platform.BodySection.appendChild(n)}}))}}t.UserSectionController=UserSectionController})(t=e.PlatformClient||(e.PlatformClient={}))})(Efferent||(Efferent={}));