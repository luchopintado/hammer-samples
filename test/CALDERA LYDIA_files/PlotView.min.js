var Efferent;(function(e){var t;(function(t){var i;(function(t){var i=e.Frontend.WebClient;var o=e.Frontend.FhirClient;class PlotView{constructor(o,n,r,a){this.ViewName="PlotView";this.optionalParameters=r["OptionalParameters"];n.LanguageManager.AddDictionary("{Efferent.ClientViews.PlotView.ResourceBag.PlotViewLanguageJson}","PlotViewLanguage",e.ClientViews.PlotView.ResourceBag.PlotViewLanguageJson[n.LanguageManager.CurrentLanguage]);this.resourceId=decodeURIComponent(a["ResourceId"]);if(this.resourceId===undefined){this.resourceId=decodeURIComponent(i.HttpUtils.GetUrlParameter("ResourceId"))}this.Platform=n;this.parent=o;this.ResourceBag=t.ResourceBag;this.SpecView=r;this.OnWindowResize(0,0);i.DOMUtils.AddClass(o,"plotContainer");this.Platform.SwitchTheme(this);this.Control=new i.PlotControl(o);this.OnWindowResize(0,0);this.Platform.ResizeListeners.push(new i.ResizeStructure(this.constructor.name.toLowerCase(),this,this.ViewName));this.createButtons();var s=Object.keys(this.optionalParameters["times"]);this.LoadData(s[0])}ShowPanes(e){}LoadData(e){var t=this.getStringDate(new Date);var n=new Date;var r=this.optionalParameters["times"][e];n.setMinutes(n.getMinutes()-r);var a=this.getStringDate(n);var s=new o.FhirCall(i.PlatformContext.PlatformUri+"/fhir/Observation?device="+this.resourceId.split("/")[1]+"&date="+a+","+t,"GET");i.Loader.Show();s.FuncOk=(e,t)=>{var o=JSON.parse(e);if(o["total"]>0){var n=o["entry"][0].resource.component;i.Loader.HideAll();this.Control.LegendSection.innerHTML="";for(var r=0;r<n.length;r++){var a;if(n[r]["code"].coding[0].hasOwnProperty("display"))a=n[r]["code"].coding[0].display;else a=n[r]["code"].coding[0].code;var s=n[r]["valueSampledData"].data.split(" ");this.Control.AddSeries(s,a)}this.Control.Render()}else{this.Control.Clear();i.Loader.HideAll();i.Toaster.ShowToast("No data to show.",i.Colors.Orange,3)}};s.FuncError=e=>{i.Loader.HideAll();i.Utils.DebugConsoleLog("OK")};s.Send()}OnWindowResize(e,t){var i=document.documentElement.clientHeight-this.Platform.ToolbarSectionHeight()-this.Platform.GetActiveMessageHeight();var o=i-30;this.parent.style.height=o+"px"}SwitchTheme(){this.Platform.SwitchTheme(this)}GetFhirEntities(){return null}GetLanguageDictionary(){return""}OnTagChanged(e){}SetInitialStatus(){}OpenActionsConfig(){}CloseActionsConfig(){}OnFullScreenChange(e){}Dispose(){}OnPopState(e){}OnBeforeUnload(e){}OnUnload(e){}getStringDate(e){var t=e.getMonth()+1;var i=e.getDate();var o=e.getMinutes();var n=e.getHours();var r=e.getSeconds();return[e.getFullYear(),this.addZero(t),this.addZero(i)].join("-")+"T"+this.addZero(n)+":"+this.addZero(o)+":"+this.addZero(r)+".0000000Z"}addZero(e){var t=e.toString();if(e<10)t="0"+e;return t}createButtons(){var e=[];for(var i in this.optionalParameters["times"]){if(this.optionalParameters["times"].hasOwnProperty(i)){var inject=()=>{var o=i;var n=[[i,t.ResourceBag.Icons8TimeSpan32Png,e=>{this.LoadData(o)}]];e.push(n)};inject()}}this.Platform.Toolbar.AppendControlsToLastGroup(e,"Efferent.PlatformClient","main")}}t.PlotView=PlotView})(i=t.PlotView||(t.PlotView={}))})(t=e.ClientViews||(e.ClientViews={}))})(Efferent||(Efferent={}));var Efferent;(function(e){var t;(function(e){var t;(function(e){class ResourceBag{}ResourceBag.PlotViewCss=`.plotContainer{width:100%;height:500px;text-align:center;display:block !important}.seriesLabel{margin-right:15px;cursor:pointer;display:inline-block;line-height:10px;text-indent:5px}`;ResourceBag.Icons8TimeSpan32Png="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAADHklEQVRYhcWXz4uWVRTHP6eZAg2kUMeMXKQxNuViZmhToTibXDhDoVD7UYkI1xFIhItk/gGzWaQgZFgtahe5yRkUwhCyGSknGJ3Cn2SRBY0NnxbPnZmn8X1+vZheuPA+955zvt/z3nPvOQfu84gmwmonsAV4EegGVgACfwA/AuPAWET8U9fmAzWBe9QjwFXgS2AH0AH8AtwAHgV2Al8BV9TD6tN1SZQBd6mj6m11Wt2n9qvr5+cS+dXqsHoy6RxSu9oF71dnrBgl+tvVCfWS2tcUfEj9Uz2qbsh7vHRW2FmmHlNvqYOtZO4IQrUfGAP+Bj4lC7LCERGvV5AI4D1gL7A5Is4WEkjn9S3wMzBTZjhH4NUqmUTiGPA88FxEXC8iMApsBXrT3kM1CNysQ1RdDpwBvo6IN1oJ9KTIHUjf69Vv2g3CAhJDCWPhikZu8wjQHREv5NY2AeeA08B+4I4HJiJONCQxBlyIiOEFAumFuwrsjYiPlii8BnwATAKftyAw0pDALmAEeGzhxVQH1Dl1ZYHSk+rp9K//pZ6Zn03Ak601CWtrfvEd9WyJHuqD6oGkPJqCqpXcJnW/eq7Eoe/UfbCYCzYA02UEIuJ2RLwNbAMGgWvqrylYn1HfVSfIYmYn8BnFyW4GeAqgMy08AlwpI5AjckLtBY4CLwEXkiPfA8eBTyJissLMZWBVngDUzIyJxDX1TbLAFBiIiFN19fNjnsBvwNomihExpfZkP2OqIe7jZLduwesp4ImGRoiIn9oAJ2Et6uWu4Zo2jDUaZjXGnLolv9ihXleH7wGBPeqN9Pj9Z+OwevIeEBhXP2y10a3OFhUOdwn8lZSMeooEDqUyatn/AP6wel49WCbUpV5MZVSjkr0CPNTjZoXtqirhvlTDHbgbJBL4SLLZW1dpMCl8XJR0atpZnjy/pW5vqtyXjmNSHWoD/OV05tO1PW9hZLX6forcMXWXJY1GyvW701WbVQ9WnXmtM0413FvAEFkbNgFcYjGDrgXWAc8CN4EvgJGI+KHKdtPmtAPYTNacbiRrTgF+Z7E5HY+IuSZ27+v4F84/z7GaNU83AAAAAElFTkSuQmCC";ResourceBag.PlotViewLanguageJson={en:{test:"test"},es:{test:"test"}};e.ResourceBag=ResourceBag})(t=e.PlotView||(e.PlotView={}))})(t=e.ClientViews||(e.ClientViews={}))})(Efferent||(Efferent={}));